import{_ as el,r as i,N as ll,O as re,$ as al,n as ce,Y as pe,c as W,d as t,b as l,w as a,y as tl,k as ol,W as sl,l as L,m as c,a as b,o as _,z as nl,i as dl,j as g,t as u,E as il,a0 as ul,g as V,G as rl,F as Y,s as K,H as cl,D as pl,e as ve,a1 as vl,u as gl,a2 as _l,a3 as ml,q as fl,x as hl,a4 as ge,v as bl,T as yl,U as Cl,V as wl,a5 as Sl,a7 as kl,B as El,C as Tl,a6 as Vl,A as Z}from"./index-DMhmhxta.js";/* empty css                 *//* empty css                   *//* empty css                        *//* empty css                      *//* empty css                  */import{t as zl}from"./TVB星河-o_Ltz7Ei.js";/* empty css               */const xl={class:"tvb"},Il={class:"tvb-header"},Dl={class:"box"},Ul={class:"select-wrap"},ql={class:"tvb-content"},Fl={class:"card-header"},Ll={class:"total"},Rl={class:"channel-controls"},$l={class:"select-name"},Nl={class:"tools"},Bl={class:"channel-content"},Ml={class:"image-slot"},Al={class:"info"},Pl={class:"channel-epg"},Gl={class:"channel-name"},Ol=["onClick"],jl={class:"card-footer"},Wl={class:"dialog-title"},Jl={class:"delete-task"},Hl={class:"msg"},Ql={class:"dialog-footer"},Xl={class:"dialog-title"},Yl={class:"delete-task"},Kl={class:"msg"},Zl={class:"msg",style:{"margin-top":"4px"}},ea={class:"dialog-footer"},la={class:"dialog-title"},aa={class:"detail"},ta={class:"detail-header"},oa={class:"img-wrap"},sa={class:"image-slot"},na={class:"detail-header-info"},da={class:"title"},ia={class:"label"},ua={class:"label"},ra={class:"label"},ca={class:"detail-content"},pa={class:"dialog-footer"},va={class:"dialog-title"},ga={class:"save-dialog"},_a={class:"desc"},ma={class:"dialog-footer"},fa="/tvbChannels",ha="/searchTvbChannels",ba="/deleteTvbChannels",ya="/deleteTvbChannel",Ca="/tvbEditChannel",wa="/tvbRefreshLogo",Sa={__name:"Tvb",setup(ka){const I=i(!1),w=i("card"),_e=[{label:"卡片",value:"card"},{label:"表格",value:"table"}],ee=localStorage.getItem("tvbShowType");ee&&(w.value=ee);const y=i("all"),n=i({page:1,pageSize:10,total:0,layout:"total, sizes, prev, pager, next, jumper"});let D={...n.value};const me=ll("xs");re(()=>{me.value?n.value.layout="pager":n.value.layout="total, sizes, prev, pager, next, jumper"});const m=i([]),S=async()=>{const s={page:n.value.page,pageSize:n.value.pageSize};I.value=!0;try{const e=await L.get(fa,{params:s});e.code==200?(m.value=e.data.data,n.value.total=e.data.total,y.value="all",D={...n.value}):(c.error(e.msg||"错误"),console.log(e.msg),n.value={...D})}catch(e){n.value={...D},c.error("获取数据失败，请稍后重试！"),console.log(e)}finally{I.value=!1}};S();const C=al({queryType:"channelName",query:""}),le=[{label:"频道名称",value:"channelName"},{label:"频道代码",value:"channelCode"},{label:"频道分组",value:"channelGroup"}],fe=ce(()=>`输入 ${le.find(e=>e.value===C.queryType).label} 搜索`),z=async()=>{y.value=="all"&&(n.value.page=1,n.value.pageSize=10);const s={page:n.value.page,pageSize:n.value.pageSize,query:C.query,queryType:C.queryType};I.value=!0;try{const e=await L.get(ha,{params:s});e.code==200?(m.value=e.data.data,n.value.total=e.data.total,y.value="search",D={...n.value}):(n.value={...D},c.error(e.msg||"错误"),console.log(e.msg))}catch(e){n.value={...D},c.error("获取数据失败，请稍后重试！"),console.log(e)}finally{I.value=!1}},he=()=>{C.query=""},be=()=>{if(C.query.trim()===""&&(C.query="",y.value=="search"))return S();z()},ye=()=>{y.value=="all"?S():z()},Ce=()=>{y.value=="all"?S():z()},f=i([]),U=i(null),B=i([]),k=i([]),we=()=>{k.value=[],B.value=[],f.value=[],U.value&&U.value.clearSelection()};re(()=>{f.value=w.value=="card"?k.value:B.value}),pe(()=>m.value,()=>{we()});const Se=s=>{B.value=s},ke=()=>{localStorage.setItem("tvbShowType",w.value),w.value=="card"?k.value=B.value:(U.value.clearSelection(),k.value.forEach(s=>{U.value.toggleRowSelection(s,!0)}))},Ee=ce(()=>f.value.length===m.value.length&&f.value.length>0),Te=()=>{w.value=="card"?k.value=k.value.length===m.value.length?[]:m.value:U.value.toggleAllSelection()},J=i(!1),R=i(!1),Ve=async()=>{const e={ids:f.value.map(r=>r.id).join(",")};J.value=!0;try{const r=await L.get(ba,{params:e});r.code==200?(Z.success({title:`删除${f.value.length}个频道成功！`,showClose:!1}),y.value=="all"?S():z(),R.value=!1):c.error(r.msg||"删除失败，请稍后重试！")}catch(r){c.error(r.msg||"请求错误！"),console.log(r)}finally{J.value=!1}},$=i(!1),M=i(null),H=i(!1),ae=s=>{M.value=s,$.value=!0},ze=async()=>{const s={id:M.value.id};H.value=!0;try{const e=await L.get(ya,{params:s});e.code==200?(Z.success({title:"删除频道成功！",showClose:!1}),$.value=!1,y.value=="all"?S():z()):c.error(e.msg||"删除失败，请稍后重试！")}catch(e){c.error(e.msg||"请求错误！"),console.log(e)}finally{H.value=!1}},A=i(!1),E=i(null),te=s=>{E.value=s,console.log(s),A.value=!0},x=i({id:"",channel_group:"",channel_code:"",name:"",logo:"",license:""});let oe={};const q={id:{label:"频道ID",placeholder:"请输入频道ID",desc:"频道的ID，不可修改",tips:"",icon:"Operation",disabled:!0},channel_group:{label:"频道分组",placeholder:"",desc:"频道的分组",tips:"",icon:"Guide",disabled:!0},channel_code:{label:"频道编码",placeholder:"",desc:"频道的编码",tips:"",icon:"Notification",disabled:!1},name:{label:"频道名称",placeholder:"请输入频道名称",desc:'频道的名称，如 "翡翠台"、"明珠台" 等',tips:"",icon:"Edit",disabled:!1},logo:{label:"频道台标URL",placeholder:"请输入频道台标URL",desc:"频道台标图片的URL地址，可为空",tips:"",icon:"CreditCard",disabled:!1},license:{label:"授权信息",placeholder:"请输入授权密钥或授权码",desc:"频道的授权密钥或授权码",tips:"",icon:"Lock",disabled:!1}},xe={logo:[{required:!0,message:"请输入频道台标URL",trigger:"blur"}],license:[{required:!0,message:"请输入授权信息",trigger:"blur"}],name:[{required:!0,message:"请输入频道名称",trigger:"blur"}]},P=i(null),N=i(!1),G=i(!1),se=s=>{if(G.value)return c.info("正在保存数据，请稍后重试！");N.value=!0,x.value={...s},oe={...x.value}},ne=()=>{P.value&&P.value.clearValidate(),N.value=!1},Ie=()=>{P.value.validate(async s=>{if(s){if(JSON.stringify(x.value)===JSON.stringify(oe))return c.info("未做任何修改");G.value=!0;let r={...x.value};try{const d=await L.get(Ca,{params:r});d.code==200?(Z.success({title:"编辑频道成功",showClose:!1}),N.value=!1,y.value=="all"?S():z()):(console.log(d.msg),c.error(d.msg||"保存失败"))}catch(d){c.error(d.msg||"请求错误！"),console.log(d)}finally{G.value=!1}}})},Q=i(!1),De=async()=>{Q.value=!0;try{const s=await L.get(wa);s.code==200?(c.success("刷新台标成功！"),y.value=="all"?S():z()):(console.log(s.msg),c.error(s.msg||"刷新失败，请稍后重试！"))}catch(s){c.error(s.msg||"请求错误！"),console.log(s)}finally{Q.value=!1}};return pe(()=>m.value,()=>{console.log("监控data"),m.value.forEach(s=>{s.logo=zl})}),(s,e)=>{const r=b("Delete"),d=il,v=dl,h=nl,Ue=b("Finished"),qe=b("Refresh"),Fe=b("Menu"),Le=b("Expand"),Re=ul,$e=cl,Ne=rl,Be=b("Search"),O=pl,F=tl,Me=_l,Ae=b("EditPen"),de=b("Monitor"),X=ml,ie=hl,Pe=vl,T=Cl,Ge=b("Edit"),Oe=wl,je=yl,We=Sl,Je=ol,j=sl,He=b("InfoFilled"),Qe=kl,Xe=b("Aim"),Ye=Tl,Ke=El,ue=bl;return _(),W("main",xl,[t("div",Il,[l(F,{gutter:15},{default:a(()=>[l(h,{xs:12,sm:12,md:3},{default:a(()=>[l(v,{type:"danger",onClick:e[0]||(e[0]=o=>R.value=!0),disabled:!f.value.length,title:f.value.length?"":"请先选择要删除的频道"},{icon:a(()=>[l(d,null,{default:a(()=>[l(r)]),_:1})]),default:a(()=>[g(" "+u(f.value.length?`删除(${f.value.length})`:"删除频道"),1)]),_:1},8,["disabled","title"])]),_:1}),l(h,{xs:12,sm:12,md:2},{default:a(()=>[l(v,{type:"info",onClick:Te},{icon:a(()=>[l(d,null,{default:a(()=>[l(Ue)]),_:1})]),default:a(()=>[g(" 全"+u(Ee.value?"不":"")+"选",1)]),_:1})]),_:1}),l(h,{xs:10,sm:8,md:3},{default:a(()=>[l(v,{type:"success",onClick:De,loading:Q.value},{icon:a(()=>[l(d,null,{default:a(()=>[l(qe)]),_:1})]),default:a(()=>[e[14]||(e[14]=g(" 刷新台标",-1))]),_:1,__:[14]},8,["loading"])]),_:1}),l(h,{xs:14,sm:16,md:4},{default:a(()=>[l(Re,{class:"showType",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=o=>w.value=o),options:_e,onChange:ke,block:""},{default:a(o=>[t("div",Dl,[o.item.value=="card"?(_(),V(d,{key:0},{default:a(()=>[l(Fe)]),_:1})):(_(),V(d,{key:1},{default:a(()=>[l(Le)]),_:1})),t("span",null,u(o.item.label),1)])]),_:1},8,["modelValue"])]),_:1}),l(h,{xs:24,sm:24,md:4},{default:a(()=>[t("div",Ul,[l(Ne,{modelValue:C.queryType,"onUpdate:modelValue":e[2]||(e[2]=o=>C.queryType=o),placeholder:"Select",size:"large",onChange:he},{default:a(()=>[(_(),W(Y,null,K(le,o=>l($e,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),_:1}),l(h,{xs:24,sm:24,md:8},{default:a(()=>[l(O,{modelValue:C.query,"onUpdate:modelValue":e[3]||(e[3]=o=>C.query=o),placeholder:fe.value,class:"searchInput",clearable:"",onChange:be},{append:a(()=>[l(d,null,{default:a(()=>[l(Be)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1})]),t("div",ql,[l(Je,{"body-style":"padding: 0px;"},{header:a(()=>[t("div",Fl,[e[15]||(e[15]=t("span",{class:"title"},"频道列表",-1)),t("span",Ll,u(n.value.total)+" 个频道",1)])]),footer:a(()=>[t("div",jl,[l(We,{background:"","current-page":n.value.page,"onUpdate:currentPage":e[5]||(e[5]=o=>n.value.page=o),"page-size":n.value.pageSize,"onUpdate:pageSize":e[6]||(e[6]=o=>n.value.pageSize=o),"page-sizes":[10,20,30],layout:n.value.layout,total:n.value.total,onSizeChange:ye,onCurrentChange:Ce,"pager-count":5},null,8,["current-page","page-size","layout","total"])])]),default:a(()=>[l(Pe,{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=o=>k.value=o),style:{"line-height":"normal","font-size":"initial"}},{default:a(()=>[ve((_(),V(F,{class:"channel-list",gutter:20},{default:a(()=>[(_(!0),W(Y,null,K(m.value,o=>(_(),V(h,{xs:24,sm:12,md:6,key:o},{default:a(()=>[t("div",{class:gl(["channel-item",{"is-checked":!1}])},[t("div",Rl,[t("div",$l,[(_(),V(Me,{label:o.name,value:o,size:"large",key:o.id},null,8,["label","value"]))]),t("div",Nl,[l(d,{class:"edit",onClick:p=>se(o)},{default:a(()=>[l(Ae)]),_:2},1032,["onClick"]),l(d,{class:"delete",onClick:p=>ae(o)},{default:a(()=>[l(r)]),_:2},1032,["onClick"])])]),t("div",Bl,[l(X,{fit:"contain",class:"image",src:o.logo},{error:a(()=>[t("div",Ml,[l(d,{size:30},{default:a(()=>[l(de)]),_:1})])]),_:2},1032,["src"]),t("div",Al,[t("p",null,"频道ID:"+u(o.id),1),t("p",null,"频道代码:"+u(o.channel_code),1),t("p",null,"授权信息:"+u(o.license),1)])]),t("div",Pl,[t("span",Gl,u(o.channel_group),1),t("span",{class:"detailBtn",onClick:p=>te(o)},"详情",8,Ol)])])]),_:2},1024))),128)),l(h,{span:24},{default:a(()=>[m.value.length==0?(_(),V(ie,{key:0,description:"暂无数据"})):fl("",!0)]),_:1})]),_:1})),[[ge,w.value=="card"],[ue,I.value]])]),_:1},8,["modelValue"]),ve((_(),V(F,{class:"channel-table"},{default:a(()=>[l(je,{data:m.value,ref_key:"dataFormRef",ref:U,onSelectionChange:Se,"header-row-class-name":"table-header","header-cell-style":{backgroundColor:"rgb(248, 249, 250)",color:"#222",borderBottom:"2px solid #333"},title:"双击查看详情",onRowDblclick:te},{empty:a(()=>[l(ie,{description:"暂无数据"})]),default:a(()=>[l(T,{fixed:"",width:"40",type:"selection"}),l(T,{prop:"logoSrc",label:"台标",width:"120"},{default:a(({row:o})=>[l(X,{fit:"cover",class:"image-logo",src:o.logo},null,8,["src"])]),_:1}),l(T,{prop:"name",label:"频道名称","min-width":"140","show-overflow-tooltip":""}),l(T,{prop:"id",label:"频道ID"}),l(T,{prop:"channel_code",label:"频道代码"}),l(T,{prop:"channel_group",label:"频道分组","min-width":"100"}),l(T,{"min-width":"160",prop:"license",label:"授权信息","show-overflow-tooltip":""}),l(T,{align:"center",label:"操作",width:"120"},{default:a(({row:o})=>[l(Oe,null,{default:a(()=>[l(v,{size:"default",type:"primary",onClick:p=>se(o)},{default:a(()=>[l(d,null,{default:a(()=>[l(Ge)]),_:1})]),_:2},1032,["onClick"]),l(v,{size:"default",type:"danger",onClick:p=>ae(o)},{default:a(()=>[l(d,null,{default:a(()=>[l(r)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})),[[ge,w.value=="table"],[ue,I.value]])]),_:1})]),l(j,{modelValue:R.value,"onUpdate:modelValue":e[8]||(e[8]=o=>R.value=o),title:"Tips",width:"500","align-center":"",class:"my-dialog danger"},{header:a(()=>[t("div",Wl,[l(d,{size:20},{default:a(()=>[l(r)]),_:1}),e[16]||(e[16]=t("span",null,"删除选中频道",-1))])]),footer:a(()=>[t("div",Ql,[l(v,{onClick:e[7]||(e[7]=o=>R.value=!1)},{default:a(()=>e[19]||(e[19]=[g("取消",-1)])),_:1,__:[19]}),l(v,{type:"danger",onClick:Ve,loading:J.value},{default:a(()=>e[20]||(e[20]=[g("确认",-1)])),_:1,__:[20]},8,["loading"])])]),default:a(()=>[t("div",Jl,[e[18]||(e[18]=t("p",{class:"title"},"确定要删除选中的频道吗？此操作不可恢复。",-1)),t("div",Hl,[e[17]||(e[17]=t("span",{class:"msg-label"},"删除内容：",-1)),t("span",null,u(f.value.length||0)+"个频道",1)])])]),_:1},8,["modelValue"]),l(j,{modelValue:$.value,"onUpdate:modelValue":e[10]||(e[10]=o=>$.value=o),title:"Tips",width:"500","align-center":"",class:"my-dialog danger"},{header:a(()=>[t("div",Xl,[l(d,{size:20},{default:a(()=>[l(r)]),_:1}),e[21]||(e[21]=t("span",null,"删除该频道",-1))])]),footer:a(()=>[t("div",ea,[l(v,{onClick:e[9]||(e[9]=o=>$.value=!1)},{default:a(()=>e[25]||(e[25]=[g("取消",-1)])),_:1,__:[25]}),l(v,{type:"danger",onClick:ze,loading:H.value},{default:a(()=>e[26]||(e[26]=[g("确认",-1)])),_:1,__:[26]},8,["loading"])])]),default:a(()=>[t("div",Yl,[e[24]||(e[24]=t("p",{class:"title"},"确定要删除该的频道吗？此操作不可恢复。",-1)),t("div",Kl,[e[22]||(e[22]=t("span",{class:"msg-label"},"频道名称：",-1)),t("span",null,u(M.value.name),1)]),t("div",Zl,[e[23]||(e[23]=t("span",{class:"msg-label"},"频道标ID：",-1)),t("span",null,u(M.value.id),1)])])]),_:1},8,["modelValue"]),l(j,{modelValue:A.value,"onUpdate:modelValue":e[12]||(e[12]=o=>A.value=o),title:"Tips","align-center":"",width:"60%",class:"my-dialog primary dialog-max-height"},{header:a(()=>[t("div",la,[l(d,{size:20},{default:a(()=>[l(He)]),_:1}),e[27]||(e[27]=t("span",null,"详情",-1))])]),footer:a(()=>[t("div",pa,[l(v,{type:"info",plain:"",onClick:e[11]||(e[11]=o=>A.value=!1)},{default:a(()=>e[33]||(e[33]=[g("关闭",-1)])),_:1,__:[33]})])]),default:a(()=>[t("div",aa,[t("div",ta,[t("div",oa,[l(X,{fit:"contain",src:E.value.logo},{error:a(()=>[t("div",sa,[l(d,{size:40},{default:a(()=>[l(de)]),_:1})])]),_:1},8,["src"])]),t("div",na,[t("p",da,u(E.value.name),1),t("p",ia,[e[28]||(e[28]=g(" 频道ID: ",-1)),t("span",null,u(E.value.id),1)]),t("p",ua,[e[29]||(e[29]=g(" 频道分组: ",-1)),t("span",null,u(E.value.channel_group),1)]),t("p",ra,[e[30]||(e[30]=g(" 频道代码: ",-1)),t("span",null,u(E.value.channel_code),1)])])]),l(Qe),t("div",ca,[l(F,null,{default:a(()=>[l(h,{span:24},{default:a(()=>[e[31]||(e[31]=t("p",{class:"label"},"台标地址",-1)),l(O,{readonly:"",size:"large",value:E.value.logo},null,8,["value"])]),_:1,__:[31]})]),_:1}),l(F,{gutter:20},{default:a(()=>[l(h,{span:24},{default:a(()=>[e[32]||(e[32]=t("p",{class:"label"},"授权信息",-1)),l(O,{readonly:"",type:"textarea",rows:3,value:E.value.license},null,8,["value"])]),_:1,__:[32]})]),_:1})])])]),_:1},8,["modelValue"]),l(j,{modelValue:N.value,"onUpdate:modelValue":e[13]||(e[13]=o=>N.value=o),width:"70%","align-center":"",class:"my-dialog primary dialog-max-height","before-close":ne},{header:a(()=>[t("div",va,[l(d,{size:20},{default:a(()=>[l(Xe)]),_:1}),e[34]||(e[34]=t("span",null,"编辑频道",-1))])]),footer:a(()=>[t("div",ma,[l(v,{onClick:ne},{default:a(()=>e[35]||(e[35]=[g("取消",-1)])),_:1,__:[35]}),l(v,{type:"primary",onClick:Ie,loading:G.value},{default:a(()=>e[36]||(e[36]=[g("保存",-1)])),_:1,__:[36]},8,["loading"])])]),default:a(()=>[t("div",ga,[l(Ke,{model:x.value,ref_key:"editTvbFormRef",ref:P,rules:xe},{default:a(()=>[l(F,{gutter:20},{default:a(()=>[(_(),W(Y,null,K(q,(o,p)=>l(h,{span:12,xs:24,key:p},{default:a(()=>[l(Ye,{label:q[p].label,prop:p,"label-position":"top"},{default:a(()=>[l(O,{size:"large",placeholder:q[p].placeholder,modelValue:x.value[p],"onUpdate:modelValue":Ze=>x.value[p]=Ze,disabled:q[p].disabled},{prepend:a(()=>[l(v,null,{icon:a(()=>[l(d,{size:18},{default:a(()=>[(_(),V(Vl(q[p].icon)))]),_:2},1024)]),_:2},1024)]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue","disabled"]),t("p",_a,u(q[p].desc),1)]),_:2},1032,["label","prop"])]),_:2},1024)),64))]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])])}}},qa=el(Sa,[["__scopeId","data-v-d92128b2"]]);export{qa as default};
