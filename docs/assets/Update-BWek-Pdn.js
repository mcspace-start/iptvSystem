import{_ as G,r as v,$ as N,c as g,b as t,w as l,k as U,a as y,o as h,d as e,t as r,j as F,G as I,F as T,s as E,H as M,i as O,E as R,u as j,f as q,a8 as A,l as H,A as w,m as J}from"./index-DMhmhxta.js";/* empty css                    *//* empty css                  */const K={class:"main"},Q={class:"executor"},W={class:"msg"},X={class:"progress hidden-xs-only"},Y={class:"card-body"},Z={class:"print-title"},ee={class:"time"},te={class:"msg"},se={__name:"Update",setup(ae){const u={iptv:{title:"æ›´æ–°ç›´æ’­æº",desc:"æ­¤åŠŸèƒ½å°†ä»ŽIPTVæœåŠ¡å™¨èŽ·å–æœ€æ–°çš„ç›´æ’­æºæ•°æ®ï¼Œå¹¶æ›´æ–°ç³»ç»Ÿä¸­çš„é¢‘é“åˆ—è¡¨ã€‚",executor:"/opt/iptv/scripts/python/iptv",url:"/update"},static_iptv:{title:"é™æ€æ›´æ–°ç›´æ’­æº",desc:"æ­¤åŠŸèƒ½å°†ä½¿ç”¨é¢„è®¾çš„é™æ€ç›´æ’­æºé…ç½®ï¼Œç”Ÿæˆæ–°çš„é¢‘é“åˆ—è¡¨æ–‡ä»¶ã€‚",executor:"/opt/iptv/scripts/python/static_iptv",url:"/update"},epg:{title:"æ›´æ–°EPG",desc:"æ­¤åŠŸèƒ½å°†ä»Žäº’è”ç½‘èŽ·å–æœ€æ–°çš„èŠ‚ç›®æŒ‡å—æ•°æ®(EPG)ï¼Œå¹¶æ›´æ–°ç³»ç»Ÿä¸­çš„èŠ‚ç›®ä¿¡æ¯ã€‚",executor:"/opt/iptv/scripts/python/epg",url:"/update"},tvb:{title:"æ›´æ–°TVBç›´æ’­æº",desc:"æ­¤åŠŸèƒ½å°†æ›´æ–°TVBé¢‘é“çš„ç›´æ’­æºæ•°æ®ï¼ŒåŒ…æ‹¬æœ€æ–°çš„é¢‘é“ä¿¡æ¯å’Œæ’­æ”¾åœ°å€ã€‚",executor:"/opt/iptv/scripts/python/tvb",url:"/update"}},n=v("iptv"),S=[{value:"iptv",label:"æ›´æ–°ç›´æ’­æº"},{value:"static_iptv",label:"é™æ€æ›´æ–°ç›´æ’­æº"},{value:"epg",label:"æ›´æ–°EPG"},{value:"tvb",label:"æ›´æ–°TVBç›´æ’­æº"}],f=v("å¼€å§‹æ›´æ–°"),p=v(!1),s=N({percentage:0,indeterminate:!1,duration:3,status:""}),c=v([]),V=()=>{p.value=!0,f.value="æ›´æ–°ä¸­...",s.percentage=100,s.indeterminate=!0},B=()=>{p.value=!1,f.value="å¼€å§‹æ›´æ–°",s.percentage=100,s.indeterminate=!1},C={iptv:"/update",static_iptv:"/update",epg:"/update",tvb:"/update"},k=async()=>{V(),c.value.push({time:`[${new Date().toLocaleTimeString()}]`,msg:`ðŸƒå¼€å§‹${u[n.value].title} ...`});const b=new Date().getTime(),a=C[n.value];try{const d=((new Date().getTime()-b)/1e3).toFixed(1),_=await H.get(a);_.code===200?((_.data.logs||[]).forEach(m=>{c.value.push({time:"[--:--:--]",msg:m})}),c.value.push({time:`[${new Date().toLocaleTimeString()}]`,msg:`âœ…æ›´æ–°æˆåŠŸï¼ - è€—æ—¶${d}ç§’`}),w.success({message:"æ›´æ–°æˆåŠŸï¼",showClose:!1}),s.status="success"):(w.error({message:"æ›´æ–°å¤±è´¥ï¼",showClose:!1}),c.value.push({time:`[${new Date().toLocaleTimeString()}]`,msg:`âŒæ›´æ–°å¤±è´¥ï¼ - è€—æ—¶${d}ç§’`}))}catch(i){J.error("è¯·æ±‚é”™è¯¯ï¼Œè¯¦æƒ…æŸ¥çœ‹æŽ§åˆ¶å°ï¼"),c.value.push({time:`[${new Date().toLocaleTimeString()}]`,msg:"ðŸŒâŒðŸ”—è¯·æ±‚é”™è¯¯!"}),console.log(`update:è¯·æ±‚é”™è¯¯!
`,i)}finally{B(),s.status="exception"}},$=()=>{c.value=[]};return(b,a)=>{const i=U,d=M,_=I,x=y("Refresh"),m=R,D=O,L=q,P=y("Tickets"),z=A;return h(),g("div",K,[t(i,{class:"alert-card"},{default:l(()=>[e("h4",null,"å…³äºŽ"+r(u[n.value].title),1),e("p",null,[F(r(u[n.value].desc)+" ",1),e("span",Q,r(u[n.value].executor),1)])]),_:1}),t(i,{class:"update-card"},{header:l(()=>a[1]||(a[1]=[e("div",{class:"card-header"},[e("span",{style:{"font-weight":"bold"}},"æ›´æ–°çŠ¶æ€")],-1)])),default:l(()=>[e("div",W,[t(_,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=o=>n.value=o),placeholder:"è¯·é€‰æ‹©",size:"large",onChange:$},{default:l(()=>[(h(),g(T,null,E(S,o=>t(d,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(D,{class:"update-button",size:"large",type:"primary",onClick:k,disabled:p.value},{default:l(()=>[t(m,{size:16,class:j({updating:p.value})},{default:l(()=>[t(x)]),_:1},8,["class"]),e("span",null,r(f.value),1)]),_:1},8,["disabled"]),e("div",X,[t(L,{status:s.status,percentage:s.percentage,indeterminate:s.indeterminate,"show-text":!1,duration:s.duration},null,8,["status","percentage","indeterminate","duration"])])])]),_:1}),t(i,{class:"log-card","body-style":{padding:0}},{header:l(()=>a[2]||(a[2]=[e("div",{class:"card-header"},[e("span",{style:{"font-weight":"bold"}},"æ›´æ–°æ—¥å¿—")],-1)])),default:l(()=>[t(z,{"max-height":"300px"},{default:l(()=>[e("ul",Y,[e("li",Z,[t(m,{class:"icon",size:16},{default:l(()=>[t(P)]),_:1}),a[3]||(a[3]=e("span",{class:"msg"},"æ›´æ–°è¿‡ç¨‹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ",-1))]),(h(!0),g(T,null,E(c.value,o=>(h(),g("li",{key:o},[e("span",ee,r(o.time),1),e("p",te,r(o.msg),1)]))),128))])]),_:1})]),_:1})])}}},ce=G(se,[["__scopeId","data-v-b31df3e4"]]);export{ce as default};
