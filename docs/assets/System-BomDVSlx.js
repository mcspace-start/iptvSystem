import{_ as fe,r as c,a as y,c as A,o as n,d as t,b as l,w as e,E as ge,D as Ce,K as sl,B as $e,y as we,F as te,s as ae,z as Te,C as Se,g as m,q as b,G as De,H as Fe,u as ol,L as rl,i as ke,l as K,m as p,M as nl,A as de,N as qe,O as Oe,P as ce,Q as Ae,k as Re,t as k,R as Ee,S as Me,j as M,e as Le,T as Be,U as He,V as Ge,x as We,v as Je,W as Xe,n as ul,p as dl,X as il}from"./index-DMhmhxta.js";/* empty css                    *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                 */const pl={class:"auth-data"},cl={class:"auto-fill"},ml={class:"auto-fill-head"},_l={class:"title"},vl={class:"desc"},fl={class:"auth-form-wrap"},gl={class:"save-btn-wrap"},bl="/authData",yl="user_id=02088888888&lang=zh-CN&stb_type=1&dhcp_user_id=99&area_name...",hl="/saveAuthData",Cl={__name:"authData",setup(be){const R=c(""),z=c({user_id:"",lang:"zh-CN",support_hd:"",net_user_id:"",dhcp_user_id:"",authenticator:"",stb_type:"",stb_version:"",conn_type:0,stb_id:"",template_name:"",area_id:"",user_token:"",user_group_id:"",product_package_id:"",mac:"00:00:00:00:00:00",user_field:0,software_version:"",desktop_id:"",is_smart_stb:!1,stb_maker:"",vip:""}),$=[{label:"用户ID",type:"text",prop:"user_id",placeholder:"请输入用户ID"},{label:"语言",type:"text",prop:"lang",placeholder:"请输入语言,例如:zh-CN"},{label:"DHCP用户ID",type:"text",prop:"dhcp_user_id",placeholder:"请输入DHCP用户ID"},{label:"认证码",type:"text",prop:"authenticator",placeholder:"请输入认证码"},{label:"机顶盒类型",type:"text",prop:"stb_type",placeholder:"请输入机顶盒类型"},{label:"机顶盒版本",type:"text",prop:"stb_version",placeholder:"请输入机顶盒版本"},{label:"连接类型",type:"number",prop:"conn_type",placeholder:"请输入连接类型(数字)"},{label:"机顶盒ID",type:"text",prop:"stb_id",placeholder:"请输入机顶盒ID"},{label:"模板名称",type:"text",prop:"template_name",placeholder:"请输入模板名称"},{label:"区域ID",type:"text",prop:"area_id",placeholder:"请输入区域ID"},{label:"用户令牌",type:"text",prop:"user_token",placeholder:"请输入用户令牌"},{label:"用户组ID",type:"text",prop:"user_group_id",placeholder:"请输入用户组ID"},{label:"产品包ID",type:"text",prop:"product_package_id",placeholder:"请输入产品包ID"},{label:"MAC地址",type:"text",prop:"mac",placeholder:"请输入MAC地址,例如:00:11:22:33:44:55"},{label:"用户字段",type:"number",prop:"user_field",placeholder:"请输入用户字段(数字)"},{label:"软件版本",type:"text",prop:"software_version",placeholder:"请输入软件版本"},{label:"是否智能机顶盒",type:"select",prop:"is_smart_stb",placeholder:"请选择是否为智能机顶盒",options:[{label:"是",value:!0},{label:"否",value:!1}]},{label:"桌面ID",type:"text",prop:"desktop_id",placeholder:"请输入桌面ID"},{label:"机顶盒制造商",type:"text",prop:"stb_maker",placeholder:"请输入机顶盒制造商"},{label:"VIP状态",type:"text",prop:"vip",placeholder:"请输入VIP状态"}],T={area_name:[{required:!0,message:"区域名称为必填项",trigger:"blur"}],user_id:[{required:!0,message:"用户ID为必填项",trigger:"blur"}],authenticator:[{required:!0,message:"认证码为必填项",trigger:"blur"}],stb_id:[{required:!0,message:"机顶盒ID为必填项",trigger:"blur"}],mac:[{pattern:/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/,message:"请输入有效的MAC地址（如 00:11:22:33:44:55 或 00-11-22-33-44-55）",trigger:"blur"}],lang:[{pattern:/^[a-z]{2}(-[A-Z]{2})?$/i,message:"请输入有效的语言格式（如 zh-CN、en-US）",trigger:"blur"}],dhcp_user_id:[{type:"string",message:"DHCP用户ID格式不正确",trigger:"blur"}],stb_type:[{type:"string",message:"机顶盒类型格式不正确",trigger:"blur"}],stb_version:[{type:"string",message:"机顶盒版本格式不正确",trigger:"blur"}],conn_type:[{pattern:/^[0-9]*$/,message:"连接类型只能是数字",trigger:"blur"}],template_name:[{type:"string",message:"模板名称格式不正确",trigger:"blur"}],area_id:[{type:"string",message:"区域ID格式不正确",trigger:"blur"}],user_token:[{type:"string",message:"用户令牌格式不正确",trigger:"blur"}],user_group_id:[{type:"string",message:"用户组ID格式不正确",trigger:"blur"}],product_package_id:[{pattern:/^-?[0-9]*$/,message:"产品包ID只能是数字",trigger:"blur"}],user_field:[{pattern:/^[0-9]*$/,message:"用户字段只能是数字",trigger:"blur"}],software_version:[{type:"string",message:"软件版本格式不正确",trigger:"blur"}],is_smart_stb:[{type:"boolean",message:"请选择是否智能机顶盒",trigger:"change"}],desktop_id:[{type:"string",message:"桌面ID格式不正确",trigger:"blur"}],stb_maker:[{type:"string",message:"机顶盒制造商格式不正确",trigger:"blur"}],vip:[{type:"string",message:"VIP状态格式不正确",trigger:"blur"}]},i=c({}),d=c(!1),J=async()=>{d.value=!0;try{const s=await K.get(bl);s.code==200?(z.value={...s.data},i.value={...s.data}):p.error(s.msg||"获取数据失败")}catch(s){p.error(s.msg||"请求失败！"),console.log(s)}finally{d.value=!1}};J();const h=c(!1),X=()=>{if(d.value)return p.info("数据加载中，请稍后操作！");h.value=!0,R.value="form"},u=()=>{q.value||(h.value=!1,z.value={...i.value},R.value="",v.value="")},v=c(""),x=()=>{Q(z,v)?(R.value="form",h.value=!0,p.success("自动识别成功，请确认配置信息！")):p.error("自动识别失败，请检查数据格式！")},Q=(s,_)=>{let g=!1;if(_.value.trim()==="")return v.value="",g;const L=_.value.split("&");for(const N of L){const[H,U]=N.split("=");s.value.hasOwnProperty(H)&&(s.value[H]=U||"",g=!0)}return g},P=c(null),q=c(!1),j=()=>{P.value.validate(s=>{if(s){if(JSON.stringify(z.value)==JSON.stringify(i.value))return p.info("未作出修改！");nl.confirm("确定对认证数据做出修改吗？","修改确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{w()}).catch(()=>{})}else return p.error("表单验证未通过！"),!1})},w=async()=>{q.value=!0;const s={...z.value};try{const _=await K.get(hl,{params:s});_.code==200?(h.value=!1,await J(),de.success({title:"保存配置成功！",showClose:!1})):p.error(_.msg||"保存配置失败")}catch(_){p.error(_.msg||"请求失败！"),console.log(_)}finally{q.value=!1}};return(s,_)=>{const g=y("MagicStick"),L=ge,N=Ce,H=y("Warning"),U=Fe,ee=De,Y=Se,C=Te,r=we,S=$e,D=sl,I=rl,le=y("Edit"),W=ke,se=y("Close"),O=y("Check");return n(),A("div",pl,[t("div",cl,[t("div",ml,[t("span",_l,[l(L,null,{default:e(()=>[l(g)]),_:1}),_[2]||(_[2]=t("span",null,"一键识别填充",-1))]),t("span",{class:"btn",onClick:x},"识别")]),l(N,{modelValue:v.value,"onUpdate:modelValue":_[0]||(_[0]=o=>v.value=o),rows:2,type:"textarea",placeholder:yl,autosize:{minRows:3}},null,8,["modelValue"]),t("p",vl,[l(L,{size:16},{default:e(()=>[l(H)]),_:1}),_[3]||(_[3]=t("span",null,'将完整的认证字符串粘贴到上方文本框，然后点击"自动识别"按钮自动填充下方表单',-1))])]),l(I,{modelValue:R.value,"onUpdate:modelValue":_[1]||(_[1]=o=>R.value=o),"expand-icon-position":"left"},{default:e(()=>[l(D,{title:"验证配置",name:"form"},{title:e(({isActive:o})=>[t("div",{class:ol({"is-active":o})},"验证配置（ 点击展开 ）",2)]),default:e(()=>[t("div",fl,[l(S,{"label-position":"top","label-width":"auto",model:z.value,rules:T,ref_key:"authFormRef",ref:P},{default:e(()=>[l(r,{gutter:20},{default:e(()=>[(n(),A(te,null,ae($,o=>l(C,{xs:24,span:12,key:o.prop},{default:e(()=>[l(Y,{label:o.label,prop:o.prop},{default:e(()=>[o.type==="text"?(n(),m(N,{key:0,type:"text",modelValue:z.value[o.prop],"onUpdate:modelValue":a=>z.value[o.prop]=a,size:"large",min:"0",placeholder:o.placeholder,disabled:!h.value},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled"])):b("",!0),o.type==="number"?(n(),m(N,{key:1,type:"number",modelValue:z.value[o.prop],"onUpdate:modelValue":a=>z.value[o.prop]=a,modelModifiers:{number:!0},size:"large",min:"0",placeholder:o.placeholder,disabled:!h.value},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled"])):b("",!0),o.type==="select"?(n(),m(ee,{key:2,modelValue:z.value[o.prop],"onUpdate:modelValue":a=>z.value[o.prop]=a,size:"large",placeholder:o.placeholder,disabled:!h.value},{default:e(()=>[(n(!0),A(te,null,ae(o.options,a=>(n(),m(U,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])):b("",!0)]),_:2},1032,["label","prop"])]),_:2},1024)),64))]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"]),t("div",gl,[h.value?b("",!0):(n(),m(W,{key:0,size:"large",type:"primary",onClick:X},{icon:e(()=>[l(L,null,{default:e(()=>[l(le)]),_:1})]),default:e(()=>[_[4]||(_[4]=t("span",null,"编辑配置",-1))]),_:1,__:[4]})),h.value?(n(),m(W,{key:1,size:"large",type:"danger",onClick:u,disabled:q.value},{icon:e(()=>[l(L,null,{default:e(()=>[l(se)]),_:1})]),default:e(()=>[_[5]||(_[5]=t("span",null,"取消",-1))]),_:1,__:[5]},8,["disabled"])):b("",!0),h.value?(n(),m(W,{key:2,size:"large",type:"success",onClick:j,loading:q.value},{icon:e(()=>[l(L,null,{default:e(()=>[l(O)]),_:1})]),default:e(()=>[_[6]||(_[6]=t("span",null,"保存配置",-1))]),_:1,__:[6]},8,["loading"])):b("",!0)])])}}},kl=fe(Cl,[["__scopeId","data-v-c40a9800"]]),xl={class:"iptv-config"},Pl={class:"tabs-wrap"},Vl={class:"card-title"},$l={class:"desc"},wl={class:"save-btn-wrap"},Tl={class:"tabs-wrap"},Sl={class:"card-title"},Rl={class:"desc"},Ul={class:"save-btn-wrap"},Il={class:"tabs-wrap"},zl={class:"card-title"},Dl={class:"desc"},Fl={class:"save-btn-wrap"},Al={class:"tabs-wrap"},El={class:"card-title"},Ml={class:"desc-wrap"},Nl={class:"desc-title"},ql={class:"desc-content"},Ol={class:"switch-wrap"},Ll={class:"save-btn-wrap"},Bl={__name:"iptvConfig",setup(be){const R=c("iptvConfig"),z=c("left"),$=qe("xs");Oe(()=>{z.value=$.value?"top":"left"});const T=c(!1),i=w=>{Q(w),T.value&&(v.value=!1)},d=c({iptvConfig:{url:"/iptvConfig",formRef:ce("iptvConfigFormRef"),form:{iptvServer:"",multicastServer:""},rules:{iptvServer:[{required:!0,message:"请输入IPTV服务器地址",trigger:"blur"},{type:"url",message:"请输入正确的服务器地址",trigger:"blur"}],multicastServer:[{required:!0,message:"请输入组播服务器地址",trigger:"blur"},{type:"url",message:"请输入正确的组播服务器地址",trigger:"blur"}]},msg:{iptvServer:{label:"IPTV服务器",desc:"设置IPTV服务器的完整地址，包括协议和端口",placeholder:"如：http://192.168.1.100:8080"},multicastServer:{label:"组播服务器",desc:"设置组播服务器的IP地址，通常为239.x.x.x格式",placeholder:"如：http://239.255.0.1:1234"}}},outputConfig:{url:"/outputConfig",formRef:ce("outputConfigFormRef"),form:{outputCombined:"",outputIgmp:"",outputRtsp:"",outputTxt:""},rules:{outputCombined:[{required:!0,message:"请输入组合输出的文件路径",trigger:"blur"},{pattern:/^[^<>:"|?*\x00-\x1f]+\.m3u$/i,message:"文件名须以.m3u结尾且不含非法字符",trigger:"blur"}],outputIgmp:[{required:!0,message:"请输入IGMP输出的文件路径",trigger:"blur"},{pattern:/^[^<>:"|?*\x00-\x1f]+\.m3u$/i,message:"文件名须以.m3u结尾且不含非法字符",trigger:"blur"}],outputRtsp:[{required:!0,message:"请输入RTSP输出的文件路径",trigger:"blur"},{pattern:/^[^<>:"|?*\x00-\x1f]+\.m3u$/i,message:"文件名须以.m3u结尾且不含非法字符",trigger:"blur"}],outputTxt:[{required:!0,message:"请输入TXT输出的文件路径",trigger:"blur"},{pattern:/^[^<>:"|?*\x00-\x1f]+\.txt$/i,message:"文件名须以.txt结尾且不含非法字符",trigger:"blur"}]},msg:{outputCombined:{label:"组合输出",desc:"RTSP和IGMP协议组合的M3U文件输出路径",placeholder:"请输入组合输出的文件路径"},outputIgmp:{label:"IGMP输出",desc:"IGMP协议的M3U文件输出路径",placeholder:"请输入IGMP输出的文件路径"},outputRtsp:{label:"RTSP输出",desc:"RTSP协议的M3U文件输出路径",placeholder:"请输入RTSP输出的文件路径"},outputTxt:{label:"TXT输出",desc:"TXT格式的频道列表文件输出路径",placeholder:"请输入TXT输出的文件路径"}}},dataFiles:{url:"/dataFiles",formRef:ce("dataFilesFormRef"),form:{extraChannelsFile:"",extraAppendM3uFile:""},rules:{extraChannelsFile:[{required:!0,message:"请输入额外频道文件的路径",trigger:"blur"},{pattern:/^[^<>:"|?*\x00-\x1f]+\.html$/i,message:"文件路径须以.html结尾且不含非法字符",trigger:"blur"}],extraAppendM3uFile:[{required:!0,message:"请输入额外M3U追加文件的路径",trigger:"blur"},{pattern:/^[^<>:"|?*\x00-\x1f]+\.m3u$/i,message:"文件路径须以.m3u结尾且不含非法字符",trigger:"blur"}]},msg:{extraChannelsFile:{label:"额外频道文件",desc:"用于提供额外频道数据的HTML文件路径",placeholder:"请输入额外频道文件的路径"},extraAppendM3uFile:{label:"额外M3U追加文件",desc:"需要追加到生成的M3U文件中的自定义M3U文件路径",placeholder:"请输入额外M3U追加文件的路径"}}},features:{url:"/features",formRef:ce(""),form:{enableRtsp:!1,enableIgmp:!1,enableCombined:!1,enableTxt:!1,enableRtpFormat:!1,enableRtspSimplify:!1,enableUserinfoReplace:!1,enableHttpUrl:!1},rules:{},msg:[{label:"功能开关设置",name:"outputSettings",children:[{label:"RTSP输出",name:"enableRtsp",desc:"启用后，将生成RTSP协议的M3U文件"},{label:"IGMP输出",name:"enableIgmp",desc:"启用后，将生成IGMP协议的M3U文件"},{label:"组合输出",name:"enableCombined",desc:"启用后，将生成RTSP+IGMP组合的M3U文件"}]},{label:"TXT文件生成控制",name:"txtControl",children:[{label:"TXT输出",name:"enableTxt",desc:"启用后，将生成TXT格式的频道列表文件"},{label:"RTP格式",name:"enableRtpFormat",desc:"启用后，IGMP地址将使用rtp://格式替代http://格式"},{label:"HTTP链接",name:"enableHttpUrl",desc:"启用后，TXT文件将调整组播和单播的顺序"}]},{label:"通用设置",name:"commonSettings",children:[{label:"RTSP简化",name:"enableRtspSimplify",desc:"启用后，将简化RTSP URL地址格式"},{label:"用户信息替换",name:"enableUserinfoReplace",desc:"启用后，将替换URL中的用户认证信息"}]}]}}),J={iptvConfig:"服务器配置",outputConfig:"输出文件",dataFiles:"数据文件",features:"功能开关"},h={iptvConfig:{},outputConfig:{},dataFiles:{},features:{}},X={iptvConfig:"/iptvConfig",outputConfig:"/outputConfig",dataFiles:"/dataFiles",features:"/features"},u=async(w=[])=>{T.value=!0;try{const s=w.map(async _=>K.get(X[_]).then(g=>{g.code==200?(d.value[_].form=g.data,h[_]={...g.data}):p.error(`获取${J[_]}数据失败!`)}));await Promise.all(s)}catch(s){p.error(s.msg||"请求错误！"),console.log(s)}finally{T.value=!1}};u(["iptvConfig","outputConfig","dataFiles","features"]);const v=c(!1),x=()=>{if(T.value)return p.info("正在加载中，请稍等");v.value=!0},Q=w=>{if(T.value)return;const s=d.value[w].formRef;s&&s.clearValidate(),d.value[w].form={...h[w]},v.value=!1},P={iptvConfig:"/updateIptvConfig",outputConfig:"/updateOutputConfig",dataFiles:"/updateDataFiles",features:"/updateFeatures"},q=w=>{if(w!=="features")d.value[w].formRef.validate(_=>{if(!(JSON.stringify(d.value[w].form)!==JSON.stringify(h[w])))return p.info("未修改任何配置");_&&j(w)});else{if(JSON.stringify(d.value[w].form)===JSON.stringify(h[w]))return p.info("未修改任何配置");j(w)}},j=async w=>{const s=P[w],_=d.value[w].form;T.value=!0;try{const g=await K.get(s,{params:_});g.code==200?(v.value=!1,de.success({title:"保存配置成功！",showClose:!1}),await u([w])):p.error(g.msg||"保存配置失败")}catch(g){p.error(g.msg||"请求错误！"),console.log(g)}finally{T.value=!1}};return(w,s)=>{const _=y("Monitor"),g=ge,L=Ce,N=Se,H=y("Warning"),U=Re,ee=Te,Y=we,C=$e,r=y("Edit"),S=ke,D=y("Close"),I=y("Check"),le=Ae,W=Ee,se=Me;return n(),A("div",xl,[l(se,{"tab-position":z.value,type:"border-card",onTabChange:i,modelValue:R.value,"onUpdate:modelValue":s[8]||(s[8]=O=>R.value=O)},{default:e(()=>[l(le,{name:"iptvConfig"},{label:e(()=>s[9]||(s[9]=[t("div",{class:"tbs-label"},"服务器设置",-1)])),default:e(()=>[t("div",Pl,[l(C,{model:d.value.iptvConfig.form,rules:d.value.iptvConfig.rules,ref:"iptvConfigFormRef"},{default:e(()=>[l(Y,{gutter:15},{default:e(()=>[(n(!0),A(te,null,ae(d.value.iptvConfig.form,(O,o)=>(n(),m(ee,{xs:24,span:12,key:o},{default:e(()=>[l(U,{"header-class":"iptv-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",Vl,[l(g,null,{default:e(()=>[l(_)]),_:1}),t("span",null,k(d.value.iptvConfig.msg[o].label),1)])]),default:e(()=>[l(N,{prop:o},{default:e(()=>[l(L,{size:"large",placeholder:d.value.iptvConfig.msg[o].placeholder,modelValue:d.value.iptvConfig.form[o],"onUpdate:modelValue":a=>d.value.iptvConfig.form[o]=a,disabled:!v.value},null,8,["placeholder","modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),t("p",$l,[l(g,null,{default:e(()=>[l(H)]),_:1}),t("span",null,k(d.value.iptvConfig.msg[o].desc),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["model","rules"]),t("div",wl,[v.value?b("",!0):(n(),m(S,{key:0,size:"large",type:"primary",onClick:x},{icon:e(()=>[l(g,null,{default:e(()=>[l(r)]),_:1})]),default:e(()=>[s[10]||(s[10]=t("span",null,"编辑配置",-1))]),_:1,__:[10]})),v.value?(n(),m(S,{key:1,size:"large",type:"danger",onClick:s[0]||(s[0]=O=>Q("iptvConfig")),disabled:T.value},{icon:e(()=>[l(g,null,{default:e(()=>[l(D)]),_:1})]),default:e(()=>[s[11]||(s[11]=t("span",null,"取消",-1))]),_:1,__:[11]},8,["disabled"])):b("",!0),v.value?(n(),m(S,{key:2,size:"large",type:"success",onClick:s[1]||(s[1]=O=>q("iptvConfig")),loading:T.value},{icon:e(()=>[l(g,null,{default:e(()=>[l(I)]),_:1})]),default:e(()=>[s[12]||(s[12]=t("span",null,"保存配置",-1))]),_:1,__:[12]},8,["loading"])):b("",!0)])])]),_:1}),l(le,{name:"outputConfig"},{label:e(()=>s[13]||(s[13]=[t("div",{class:"tbs-label"},"输出文件",-1)])),default:e(()=>[t("div",Tl,[l(C,{model:d.value.outputConfig.form,rules:d.value.outputConfig.rules,ref:"outputConfigFormRef"},{default:e(()=>[l(Y,{gutter:15},{default:e(()=>[(n(!0),A(te,null,ae(d.value.outputConfig.form,(O,o)=>(n(),m(ee,{xs:24,span:12,key:o},{default:e(()=>[l(U,{"header-class":"iptv-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",Sl,[l(g,null,{default:e(()=>[l(_)]),_:1}),t("span",null,k(d.value.outputConfig.msg[o].label),1)])]),default:e(()=>[l(N,{prop:o},{default:e(()=>[l(L,{size:"large",placeholder:d.value.outputConfig.msg[o].placeholder,modelValue:d.value.outputConfig.form[o],"onUpdate:modelValue":a=>d.value.outputConfig.form[o]=a,disabled:!v.value},null,8,["placeholder","modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),t("p",Rl,[l(g,null,{default:e(()=>[l(H)]),_:1}),t("span",null,k(d.value.outputConfig.msg[o].desc),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["model","rules"]),t("div",Ul,[v.value?b("",!0):(n(),m(S,{key:0,size:"large",type:"primary",onClick:x},{icon:e(()=>[l(g,null,{default:e(()=>[l(r)]),_:1})]),default:e(()=>[s[14]||(s[14]=t("span",null,"编辑配置",-1))]),_:1,__:[14]})),v.value?(n(),m(S,{key:1,size:"large",type:"danger",onClick:s[2]||(s[2]=O=>Q("outputConfig"))},{icon:e(()=>[l(g,null,{default:e(()=>[l(D)]),_:1})]),default:e(()=>[s[15]||(s[15]=t("span",null,"取消",-1))]),_:1,__:[15]})):b("",!0),v.value?(n(),m(S,{key:2,size:"large",type:"success",onClick:s[3]||(s[3]=O=>q("outputConfig")),loading:T.value},{icon:e(()=>[l(g,null,{default:e(()=>[l(I)]),_:1})]),default:e(()=>[s[16]||(s[16]=t("span",null,"保存配置",-1))]),_:1,__:[16]},8,["loading"])):b("",!0)])])]),_:1}),l(le,{name:"dataFiles"},{label:e(()=>s[17]||(s[17]=[t("div",{class:"tbs-label"},"数据文件",-1)])),default:e(()=>[t("div",Il,[l(C,{model:d.value.dataFiles.form,rules:d.value.dataFiles.rules,ref:"dataFilesFormRef"},{default:e(()=>[l(Y,{gutter:15},{default:e(()=>[(n(!0),A(te,null,ae(d.value.dataFiles.form,(O,o)=>(n(),m(ee,{xs:24,span:12,key:o},{default:e(()=>[l(U,{"header-class":"iptv-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",zl,[l(g,null,{default:e(()=>[l(_)]),_:1}),t("span",null,k(d.value.dataFiles.msg[o].label),1)])]),default:e(()=>[l(N,{prop:o},{default:e(()=>[l(L,{size:"large",placeholder:d.value.dataFiles.msg[o].placeholder,modelValue:d.value.dataFiles.form[o],"onUpdate:modelValue":a=>d.value.dataFiles.form[o]=a,disabled:!v.value},null,8,["placeholder","modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),t("p",Dl,[l(g,null,{default:e(()=>[l(H)]),_:1}),t("span",null,k(d.value.dataFiles.msg[o].desc),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["model","rules"]),t("div",Fl,[v.value?b("",!0):(n(),m(S,{key:0,size:"large",type:"primary",onClick:x},{icon:e(()=>[l(g,null,{default:e(()=>[l(r)]),_:1})]),default:e(()=>[s[18]||(s[18]=t("span",null,"编辑配置",-1))]),_:1,__:[18]})),v.value?(n(),m(S,{key:1,size:"large",type:"danger",onClick:s[4]||(s[4]=O=>Q("dataFiles"))},{icon:e(()=>[l(g,null,{default:e(()=>[l(D)]),_:1})]),default:e(()=>[s[19]||(s[19]=t("span",null,"取消",-1))]),_:1,__:[19]})):b("",!0),v.value?(n(),m(S,{key:2,size:"large",type:"success",onClick:s[5]||(s[5]=O=>q("dataFiles")),loading:T.value},{icon:e(()=>[l(g,null,{default:e(()=>[l(I)]),_:1})]),default:e(()=>[s[20]||(s[20]=t("span",null,"保存配置",-1))]),_:1,__:[20]},8,["loading"])):b("",!0)])])]),_:1}),l(le,{name:"features"},{label:e(()=>s[21]||(s[21]=[t("div",{class:"tbs-label"},"功能开关",-1)])),default:e(()=>[t("div",Al,[l(Y,{gutter:15},{default:e(()=>[(n(!0),A(te,null,ae(d.value.features.msg,(O,o)=>(n(),m(ee,{span:24,key:o},{default:e(()=>[l(U,{"header-class":"iptv-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",El,[l(g,null,{default:e(()=>[l(_)]),_:1}),t("span",null,k(O.label),1)])]),default:e(()=>[(n(!0),A(te,null,ae(O.children,(a,B)=>(n(),A("div",{class:"switch-wrap",key:B},[t("div",Ml,[t("span",Nl,k(a.label),1),t("span",ql,k(a.desc),1)]),t("div",Ol,[l(W,{modelValue:d.value.features.form[a.name],"onUpdate:modelValue":V=>d.value.features.form[a.name]=V,disabled:!v.value},null,8,["modelValue","onUpdate:modelValue","disabled"])])]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1}),t("div",Ll,[v.value?b("",!0):(n(),m(S,{key:0,size:"large",type:"primary",onClick:x},{icon:e(()=>[l(g,null,{default:e(()=>[l(r)]),_:1})]),default:e(()=>[s[22]||(s[22]=t("span",null,"编辑配置",-1))]),_:1,__:[22]})),v.value?(n(),m(S,{key:1,size:"large",type:"danger",onClick:s[6]||(s[6]=O=>Q("features"))},{icon:e(()=>[l(g,null,{default:e(()=>[l(D)]),_:1})]),default:e(()=>[s[23]||(s[23]=t("span",null,"取消",-1))]),_:1,__:[23]})):b("",!0),v.value?(n(),m(S,{key:2,size:"large",type:"success",onClick:s[7]||(s[7]=O=>q("features")),loading:T.value},{icon:e(()=>[l(g,null,{default:e(()=>[l(I)]),_:1})]),default:e(()=>[s[24]||(s[24]=t("span",null,"保存配置",-1))]),_:1,__:[24]},8,["loading"])):b("",!0)])])]),_:1})]),_:1},8,["tab-position","modelValue"])])}}},Hl=fe(Bl,[["__scopeId","data-v-c783c93b"]]),Gl={class:"rtsp-proxy"},Wl={class:"tabs-wrap"},Jl={class:"card-title"},Xl={class:"form-item"},Kl={class:"desc"},Zl={class:"switch-wrap"},jl={class:"desc-wrap"},Ql={class:"desc-title"},Yl={class:"desc-content"},et={class:"switch-wrap"},lt={class:"btn-wrap"},tt={class:"tabs-wrap"},at={class:"card-title"},st={class:"item-label"},ot={class:"desc"},rt={class:"btn-wrap"},nt={class:"tabs-wrap"},ut={class:"header"},dt={class:"btn-wrap"},it={class:"table-wrap"},pt={class:"tools-bar"},ct={class:"dialog-title"},mt={class:"save-dialog-content"},_t={class:"dialog-footer"},vt={class:"dialog-title"},ft={class:"delete-dialog-content"},gt={class:"content"},bt={class:"name"},yt={class:"dialog-footer"},ht="/serverAddressList",Ct="/addServers",kt="/updateServers",xt="/deleteServers",Pt={__name:"rtspProxy",setup(be){const R=c("rtspProxy"),z=()=>{const o=i.value.rtspProxy.formRef,a=i.value.rtspProxyServer.formRef;o&&(o.clearValidate(),i.value.rtspProxy.form={...d.rtspProxy}),a&&(a.clearValidate(),i.value.rtspProxyServer.form={...d.rtspProxyServer}),u.value=!1},$=c("left"),T=qe("xs");Oe(()=>{$.value=T.value?"top":"left"});const i=c({rtspProxy:{url:"/rtspProxy",formRef:ce("rtspProxyFormRef"),form:{rtspProxyUrl:"",enableRtspIpReplace:!1},msg:{rtspProxyUrl:{label:"RTSP代理服务器地址",placeholder:"设置RTSP代理服务器地址",desc:"设置RTSP代理服务器地址，用于转发RTSP流媒体请求"},enableRtspIpReplace:{label:"RTSP IP替换",placeholder:"设置RTSP IP替换",desc:"启用后，系统会自动替换RTSP URL中的IP地址为代理服务器地址"}},rules:{rtspProxyUrl:[{pattern:/^rtsp:\/\/[a-zA-Z0-9.-]+(:[0-9]+)?(@[a-zA-Z0-9.-]+(:[0-9]+)?)?\/.*$/,message:"请输入有效的RTSP代理服务器地址",trigger:"blur"}]}},rtspProxyServer:{url:"/serverAddressList",formRef:ce("rtspProxyServerFormRef"),form:{serverAddress:"127.0.0.1",serverPort:1,listenAddress:"127.0.0.1",listenPort:1,bufferSize:1,timeout:.1,keepAliveInterval:1,keepAliveMethod:"OPTIONS",keepAliveCseqStart:1,retryDelay:.1,connectionCheckInterval:1,maxRetries:1,selectTimeout:.1,maxRedirects:0},msg:[{title:"服务器连接设置",name:"serverConnection",children:[{name:"serverAddress",desc:"选择服务器或输入自定义地址",label:"服务器地址",placeholder:"RTSP服务器地址",type:"comp"},{name:"serverPort",desc:"RTSP服务器监听的端口号",label:"服务器端口",placeholder:"服务器端口",type:"number"}]},{title:"本地监听设置",name:"localListener",children:[{name:"listenAddress",desc:"本地代理服务器绑定的IP地址",label:"监听地址",placeholder:"监听地址",type:"text"},{name:"listenPort",desc:"本地代理服务器监听的端口号",label:"监听端口",placeholder:"监听端口",type:"number"}]},{title:"保活设置",name:"keepAlive",children:[{name:"keepAliveInterval",desc:"发送保活请求的时间间隔",label:"保活间隔(秒)",placeholder:"保活间隔",type:"number"},{name:"keepAliveMethod",desc:"RTSP保活请求使用的方法",label:"保活方法",type:"select",options:["OPTIONS","GET_PARAMETER"]},{name:"keepAliveCseqStart",desc:"保活请求序列号起始值",label:"保活CSeq起始值",placeholder:"CSeq起始值",type:"number"}]},{title:"重试设置",name:"retrySettings",children:[{name:"retryDelay",desc:"连接失败后重试的延迟时间",label:"重试延迟(秒)",placeholder:"重试延迟",type:"number"},{name:"maxRetries",desc:"连接失败后尝试重连的最大次数",label:"最大重试次数",placeholder:"最大重试次数",type:"number"},{name:"maxRedirects",desc:"允许的RTSP重定向响应的最大次数",label:"最大重定向次数",placeholder:"最大重定向次数",type:"number"}]},{title:"缓冲区设置",name:"bufferSettings",children:[{name:"bufferSize",desc:"数据传输缓冲区大小（字节）",label:"缓冲区大小",placeholder:"缓冲区大小",type:"number"},{name:"timeout",desc:"连接超时时间设置",label:"超时时间(秒)",placeholder:"超时时间(秒)",type:"number"}]},{title:"连接设置",name:"connectionSettings",children:[{name:"connectionCheckInterval",desc:"连接检查间隔",label:"连接检查间隔(秒)",placeholder:"连接检查间隔(秒)",type:"number"},{name:"selectTimeout",desc:"select系统调用的超时时间",label:"选择超时(秒)",placeholder:"选择超时(秒)",type:"number"}]}],rules:{serverAddress:[{type:"string",message:"请输入有效的服务器地址",trigger:"blur"},{pattern:/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,message:"请输入有效的IP地址",trigger:"blur"}],serverPort:[{pattern:/^(6553[0-5]|655[0-2]\d|65[0-4]\d{2}|6[0-4]\d{3}|[1-5]\d{4}|[1-9]\d{0,3})$/,message:"端口号范围为1-65535",trigger:"blur"}],listenAddress:[{type:"string",message:"请输入有效的监听地址",trigger:"blur"},{pattern:/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,message:"请输入有效的IP地址",trigger:"blur"}],listenPort:[{pattern:/^(6553[0-5]|655[0-2]\d|65[0-4]\d{2}|6[0-4]\d{3}|[1-5]\d{4}|[1-9]\d{0,3})$/,message:"端口号范围为1-65535",trigger:"blur"}],bufferSize:[{pattern:/^[1-9]\d*$/,message:"缓冲区大小必须大于0的整数",trigger:"blur"}],timeout:[{pattern:/^(0\.[1-9]\d*|[1-9]\d*)$/,message:"超时时间必须大于0",trigger:"blur"}],keepAliveInterval:[{pattern:/^[1-9]\d*$/,message:"保活间隔必须大于0的整数",trigger:"blur"}],keepAliveCseqStart:[{pattern:/^[1-9]\d*$/,message:"保活序列号起始值必须大于0的整数",trigger:"blur"}],retryDelay:[{pattern:/^(0\.[1-9]\d*|[1-9]\d*)$/,message:"重试延迟必须大于0",trigger:"blur"}],connectionCheckInterval:[{pattern:/^[1-9]\d*$/,message:"连接检查间隔必须大于0的整数",trigger:"blur"}],maxRetries:[{pattern:/^[0-9]\d*$/,message:"最大重试次数必须大于等于0的整数",trigger:"blur"}],selectTimeout:[{pattern:/^(0\.[1-9]\d*|[1-9]\d*)$/,message:"选择超时必须大于0",trigger:"blur"}],maxRedirects:[{pattern:/^[0-9]\d*$/,message:"最大重定向次数必须大于等于0的整数",trigger:"blur"}]}},servers:{url:"/servers",formRef:ce("serversTable"),form:[],msg:{},rules:{}}}),d={rtspProxy:{},rtspProxyServer:{},servers:{}},J={rtspProxy:"/rtspProxy",rtspProxyServer:"/rtspProxyServer",servers:"/servers"},h=c(!1),X=async(o=[])=>{h.value=!0;try{const a=o.map(B=>K.get(J[B]).then(V=>{V.code==200?(i.value[B].form=V.data,d[B]={...V.data}):p.error(`获取${typeMsg[B]}数据失败!`)}));await Promise.all(a)}catch(a){p.error(a.msg||"请求失败！"),console.log(a)}finally{h.value=!1}};X(["rtspProxy","rtspProxyServer","servers"]);const u=c(!1),v=()=>{if(h.value)return p.info("正在加载中，请稍等");u.value=!0},x=o=>{if(h.value)return;const a=i.value[o].formRef;a&&a.clearValidate(),i.value[o].form={...d[o]},u.value=!1},Q={rtspProxy:"/updateRtspProxy",rtspProxyServer:"/updateRtspProxyServer",servers:""},P=o=>{i.value[o].formRef.validate(B=>{if(!(JSON.stringify(i.value[o].form)!==JSON.stringify(d[o])))return p.info("未修改任何配置");B&&q(o)})},q=async o=>{const a=Q[o],B=i.value[o].form;h.value=!0;try{const V=await K.get(a,{params:B});V.code==200?(u.value=!1,de.success({title:"保存配置成功！",showClose:!1}),await X([o])):p.error(V.msg||"保存失败")}catch(V){p.error(V.msg||"请求错误！"),console.log(V)}finally{h.value=!1}},j=c(""),w=c(!1),s=c([]),_=async()=>{if(s.value.length===0){w.value=!0;try{const o=await K.get(ht);o.code==200?s.value=o.data:(p.error("获取地址失败，请稍后重试！"),console.log(o.msg))}catch(o){p.error(o.msg||"请求失败！"),console.log(o)}finally{w.value=!1}}},g=o=>{let a=1;return o==="selectTimeout"&&(a=.1),o==="bufferSize"&&(a=1024),a},L=c(!1),N=c(!1),H=c(!1),U=c({serverAddress:"",serverName:""}),ee={serverAddress:[{required:!0,message:"服务器地址不能为空",trigger:"blur"},{pattern:/^rtsp:\/\/\d{1,3}(\.\d{1,3}){3}:\d+$/,message:"请输入正确服务器地址",trigger:"blur"}],serverName:[{required:!0,message:"服务器名称不能为空",trigger:"blur"}]},Y=c(null);let C={},r="";const S=(o,a)=>{if(H.value)return p.info("正在保存，请稍后");Y.value&&Y.value.clearValidate(),o==="add"?(L.value=!1,r=Ct,U.value={serverAddress:"",serverName:""}):o==="edit"&&(L.value=!0,r=kt,U.value={...a},C={...a}),N.value=!0},D=()=>{let o={};L.value?o={id:U.value.id,data:{serverAddress:U.value.serverAddress,serverName:U.value.serverName}}:o=U.value,Y.value.validate(async a=>{if(a){if(JSON.stringify(U.value)==JSON.stringify(C))return p.info("未做任何修改!");H.value=!0;try{const B=await K.get(r,{params:o});if(B.code==200){const V=L.value?"编辑":"添加";de.success({title:`${V}服务器成功!`}),N.value=!1,await X(["servers"])}else p.error(B.msg||"保存失败")}catch(B){p.error(B.msg||"请求错误！"),console.log(B)}finally{H.value=!1}}})},I=c(!1),le=c("[任务名称]"),W=c(!1),se=o=>{if(W.value)return p.info("正在删除，请稍后");le.value=o,I.value=!0},O=async()=>{W.value=!0;const o={id:le.value.id};try{const a=await K.get(xt,{params:o});a.code==200?(de.success({title:"删除成功任务!",showClose:!1}),I.value=!1,await X(["servers"])):p.error(a.msg||"删除失败")}catch(a){p.error(a.msg||"请求错误！"),console.log(a)}finally{W.value=!1}};return(o,a)=>{const B=y("Link"),V=ge,ie=Ce,me=Se,ye=$e,_e=y("Warning"),Ue=Ee,re=Re,oe=Te,xe=we,ne=y("Edit"),Z=ke,Pe=y("Close"),pe=y("Check"),he=Ae,Ie=y("Cpu"),ve=Fe,Ve=De,f=y("Plus"),ue=He,Ke=y("Delete"),Ze=Ge,je=We,Qe=Be,Ye=Me,el=y("PriceTag"),Ne=Xe,ll=Je;return n(),A("div",Gl,[l(Ye,{"tab-position":$.value,class:"demo-tabs",type:"border-card",modelValue:R.value,"onUpdate:modelValue":a[9]||(a[9]=F=>R.value=F),onTabChange:z},{default:e(()=>[l(he,{name:"rtspProxy"},{label:e(()=>a[16]||(a[16]=[t("div",{class:"tab-label"},"代理服务器地址",-1)])),default:e(()=>[t("div",Wl,[l(xe,{gutter:15},{default:e(()=>[l(oe,null,{default:e(()=>[l(re,{"header-class":"iptv-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",Jl,[l(V,null,{default:e(()=>[l(B)]),_:1}),t("span",null,k(i.value.rtspProxy.msg.rtspProxyUrl.label),1)])]),default:e(()=>[t("div",Xl,[l(ye,{model:i.value.rtspProxy.form,rules:i.value.rtspProxy.rules,ref:"rtspProxyFormRef"},{default:e(()=>[l(me,{prop:"rtspProxyUrl"},{default:e(()=>[l(ie,{size:"large",placeholder:i.value.rtspProxy.msg.rtspProxyUrl.placeholder,disabled:!u.value,modelValue:i.value.rtspProxy.form.rtspProxyUrl,"onUpdate:modelValue":a[0]||(a[0]=F=>i.value.rtspProxy.form.rtspProxyUrl=F)},null,8,["placeholder","disabled","modelValue"])]),_:1})]),_:1},8,["model","rules"]),t("p",Kl,[l(V,null,{default:e(()=>[l(_e)]),_:1}),t("span",null,k(i.value.rtspProxy.msg.rtspProxyUrl.desc),1)]),a[17]||(a[17]=t("p",{style:{"margin-top":"10px"}},null,-1)),t("div",Zl,[t("div",jl,[t("span",Ql,k(i.value.rtspProxy.msg.enableRtspIpReplace.label),1),t("span",Yl,k(i.value.rtspProxy.msg.enableRtspIpReplace.desc),1)]),t("div",et,[l(Ue,{modelValue:i.value.rtspProxy.form.enableRtspIpReplace,"onUpdate:modelValue":a[1]||(a[1]=F=>i.value.rtspProxy.form.enableRtspIpReplace=F),disabled:!u.value},null,8,["modelValue","disabled"])])])])]),_:1})]),_:1})]),_:1}),t("div",lt,[u.value?b("",!0):(n(),m(Z,{key:0,size:"large",type:"primary",onClick:v},{icon:e(()=>[l(V,null,{default:e(()=>[l(ne)]),_:1})]),default:e(()=>[a[18]||(a[18]=t("span",null,"编辑配置",-1))]),_:1,__:[18]})),u.value?(n(),m(Z,{key:1,size:"large",type:"danger",onClick:a[2]||(a[2]=F=>x("rtspProxy")),disabled:h.value},{icon:e(()=>[l(V,null,{default:e(()=>[l(Pe)]),_:1})]),default:e(()=>[a[19]||(a[19]=t("span",null,"取消",-1))]),_:1,__:[19]},8,["disabled"])):b("",!0),u.value?(n(),m(Z,{key:2,size:"large",type:"success",loading:h.value,onClick:a[3]||(a[3]=F=>P("rtspProxy"))},{icon:e(()=>[l(V,null,{default:e(()=>[l(pe)]),_:1})]),default:e(()=>[a[20]||(a[20]=t("span",null,"保存配置",-1))]),_:1,__:[20]},8,["loading"])):b("",!0)])])]),_:1}),l(he,{name:"rtspProxyServer"},{label:e(()=>a[21]||(a[21]=[t("div",{class:"tab-label"},"代理服务器配置",-1)])),default:e(()=>[t("div",tt,[l(ye,{model:i.value.rtspProxyServer.form,rules:i.value.rtspProxyServer.rules,ref:"rtspProxyServerFormRef"},{default:e(()=>[l(xe,{gutter:15},{default:e(()=>[(n(!0),A(te,null,ae(i.value.rtspProxyServer.msg,(F,ze)=>(n(),m(oe,{xs:24,span:12,key:ze},{default:e(()=>[l(re,{"header-class":"iptv-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",at,[l(V,null,{default:e(()=>[l(Ie)]),_:1}),t("span",null,k(F.title),1)])]),default:e(()=>[(n(!0),A(te,null,ae(F.children,(E,tl)=>(n(),A("div",{class:"form-item",key:tl},[t("p",st,k(E.label),1),l(me,{prop:E.name},{default:e(()=>[E.type==="comp"?(n(),m(ie,{key:0,placeholder:E.placeholder,size:"large",modelValue:i.value.rtspProxyServer.form[E.name],"onUpdate:modelValue":G=>i.value.rtspProxyServer.form[E.name]=G,onInput:a[5]||(a[5]=G=>j.value=""),disabled:!u.value},{append:e(()=>[l(Ve,{placeholder:"自定义",style:{"min-width":"150px"},size:"large",modelValue:j.value,"onUpdate:modelValue":a[4]||(a[4]=G=>j.value=G),disabled:!u.value,loading:w.value,onVisibleChange:_,onChange:G=>i.value.rtspProxyServer.form[E.name]=j.value},{default:e(()=>[(n(!0),A(te,null,ae(s.value,(G,al)=>(n(),m(ve,{key:al,label:G.serverName,value:G.serverAddress},null,8,["label","value"]))),128)),l(ve,{label:"自定义",value:""})]),_:2},1032,["modelValue","disabled","loading","onChange"])]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue","disabled"])):b("",!0),E.type==="text"?(n(),m(ie,{key:1,size:"large",placeholder:E.placeholder,modelValue:i.value.rtspProxyServer.form[E.name],"onUpdate:modelValue":G=>i.value.rtspProxyServer.form[E.name]=G,type:E.type,disabled:!u.value},null,8,["placeholder","modelValue","onUpdate:modelValue","type","disabled"])):b("",!0),E.type==="number"?(n(),m(ie,{key:2,size:"large",placeholder:E.placeholder,modelValue:i.value.rtspProxyServer.form[E.name],"onUpdate:modelValue":G=>i.value.rtspProxyServer.form[E.name]=G,modelModifiers:{number:!0},type:E.type,step:g(E.name),disabled:!u.value,min:"0"},null,8,["placeholder","modelValue","onUpdate:modelValue","type","step","disabled"])):b("",!0),E.type==="select"?(n(),m(Ve,{key:3,size:"large",placeholder:E.placeholder,modelValue:i.value.rtspProxyServer.form[E.name],"onUpdate:modelValue":G=>i.value.rtspProxyServer.form[E.name]=G,disabled:!u.value},{default:e(()=>[(n(!0),A(te,null,ae(E.options,G=>(n(),m(ve,{key:G,label:G,value:G},null,8,["label","value"]))),128))]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue","disabled"])):b("",!0)]),_:2},1032,["prop"]),t("p",ot,[l(V,null,{default:e(()=>[l(_e)]),_:1}),t("span",null,k(E.desc),1)])]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["model","rules"]),t("div",rt,[u.value?b("",!0):(n(),m(Z,{key:0,size:"large",type:"primary",onClick:v},{icon:e(()=>[l(V,null,{default:e(()=>[l(ne)]),_:1})]),default:e(()=>[a[22]||(a[22]=t("span",null,"编辑配置",-1))]),_:1,__:[22]})),u.value?(n(),m(Z,{key:1,size:"large",type:"danger",onClick:a[6]||(a[6]=F=>x("rtspProxyServer")),disabled:h.value},{icon:e(()=>[l(V,null,{default:e(()=>[l(Pe)]),_:1})]),default:e(()=>[a[23]||(a[23]=t("span",null,"取消",-1))]),_:1,__:[23]},8,["disabled"])):b("",!0),u.value?(n(),m(Z,{key:2,size:"large",type:"success",loading:h.value,onClick:a[7]||(a[7]=F=>P("rtspProxyServer"))},{icon:e(()=>[l(V,null,{default:e(()=>[l(pe)]),_:1})]),default:e(()=>[a[24]||(a[24]=t("span",null,"保存配置",-1))]),_:1,__:[24]},8,["loading"])):b("",!0)])])]),_:1}),l(he,{name:"servers"},{label:e(()=>a[25]||(a[25]=[t("div",{class:"tab-label"},"服务器选择键",-1)])),default:e(()=>[t("div",nt,[t("div",ut,[a[27]||(a[27]=t("div",{class:"title hidden-xs-only"},"服务器选择键",-1)),t("div",dt,[l(Z,{type:"primary",size:"large",onClick:a[8]||(a[8]=F=>S("add"))},{icon:e(()=>[l(V,null,{default:e(()=>[l(f)]),_:1})]),default:e(()=>[a[26]||(a[26]=M(" 添加服务器 ",-1))]),_:1,__:[26]})])]),t("div",it,[Le((n(),m(Qe,{data:i.value.servers.form,"header-row-class-name":"scheduled-task-table-header"},{empty:e(()=>[l(je,{"image-size":100,class:"table-empty",description:"暂无数据"})]),default:e(()=>[l(ue,{label:"#",width:"40",type:"index"}),l(ue,{prop:"id",label:"ID","min-width":"40","show-overflow-tooltip":""}),l(ue,{prop:"serverName",label:"服务器名称","min-width":"140","show-overflow-tooltip":""}),l(ue,{prop:"serverAddress",label:"服务器地址","min-width":"190","show-overflow-tooltip":""}),l(ue,{label:"操作",width:"120"},{default:e(({row:F})=>[t("div",pt,[l(Ze,null,{default:e(()=>[l(Z,{type:"primary",onClick:ze=>S("edit",F)},{default:e(()=>[l(V,null,{default:e(()=>[l(ne)]),_:1})]),_:2},1032,["onClick"]),l(Z,{type:"danger",onClick:ze=>se(F)},{default:e(()=>[l(V,null,{default:e(()=>[l(Ke)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[ll,h.value]])])])]),_:1})]),_:1},8,["tab-position","modelValue"]),l(Ne,{modelValue:N.value,"onUpdate:modelValue":a[13]||(a[13]=F=>N.value=F),title:"Tips",width:"500","align-center":"",class:"my-dialog primary"},{header:e(()=>[t("div",ct,[l(V,{size:20},{default:e(()=>[l(_e)]),_:1}),t("span",null,k(L.value?"编辑":"添加")+"服务器",1)])]),footer:e(()=>[t("div",_t,[l(Z,{onClick:a[12]||(a[12]=F=>N.value=!1)},{default:e(()=>a[28]||(a[28]=[M("取消",-1)])),_:1,__:[28]}),l(Z,{type:"primary",onClick:D,loading:H.value},{default:e(()=>a[29]||(a[29]=[M("确认",-1)])),_:1,__:[29]},8,["loading"])])]),default:e(()=>[t("div",mt,[l(ye,{model:U.value,rules:ee,ref_key:"saveServersFormRef",ref:Y,"label-position":"top"},{default:e(()=>[l(me,{label:"服务器名称",prop:"serverName",required:""},{default:e(()=>[l(ie,{size:"large",placeholder:"请输入服务器名称",modelValue:U.value.serverName,"onUpdate:modelValue":a[10]||(a[10]=F=>U.value.serverName=F)},{prefix:e(()=>[l(V,null,{default:e(()=>[l(el)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(me,{label:"服务器地址",prop:"serverAddress",required:""},{default:e(()=>[l(ie,{size:"large",placeholder:"请输入服务器地址",modelValue:U.value.serverAddress,"onUpdate:modelValue":a[11]||(a[11]=F=>U.value.serverAddress=F)},{prefix:e(()=>[l(V,null,{default:e(()=>[l(B)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),l(Ne,{modelValue:I.value,"onUpdate:modelValue":a[15]||(a[15]=F=>I.value=F),title:"Tips",width:"500","align-center":"",class:"my-dialog danger"},{header:e(()=>[t("div",vt,[l(V,{size:20},{default:e(()=>[l(_e)]),_:1}),a[30]||(a[30]=t("span",null,"删除确认",-1))])]),footer:e(()=>[t("div",yt,[l(Z,{onClick:a[14]||(a[14]=F=>I.value=!1)},{default:e(()=>a[33]||(a[33]=[M("取消",-1)])),_:1,__:[33]}),l(Z,{type:"danger",onClick:O,loading:W.value},{default:e(()=>a[34]||(a[34]=[M("确认",-1)])),_:1,__:[34]},8,["loading"])])]),default:e(()=>[t("div",ft,[a[32]||(a[32]=t("p",{class:"title"},"确定要删除这个服务器吗？",-1)),t("p",gt,[a[31]||(a[31]=t("span",{class:"label"},"任务名称：",-1)),t("span",bt,k(le.value.serverName),1)])])]),_:1},8,["modelValue"])])}}},Vt=fe(Pt,[["__scopeId","data-v-1dfd383f"]]),$t={class:"scheduled-task"},wt={class:"header"},Tt={class:"btn-wrap"},St={class:"table-wrap"},Rt={class:"time"},Ut={class:"time"},It={class:"time"},zt={class:"time"},Dt={class:"time"},Ft={class:"tools-bar"},At={class:"card-title"},Et={class:"dialog-title"},Mt={class:"save-dialog"},Nt={class:"desc"},qt={class:"desc"},Ot={class:"label"},Lt={class:"desc hidden-xs-only"},Bt={class:"label"},Ht={class:"desc hidden-xs-only"},Gt={key:0,class:"desc info"},Wt={class:"label"},Jt={class:"desc hidden-xs-only"},Xt={key:0,class:"desc info"},Kt={class:"label"},Zt={class:"desc hidden-xs-only"},jt={key:0,class:"desc"},Qt={class:"label"},Yt={class:"desc hidden-xs-only"},ea={key:0,class:"desc info"},la={key:1,class:"desc"},ta={class:"switch-wrap"},aa={class:"switch-label"},sa={class:"dialog-footer"},oa={class:"dialog-title"},ra={class:"delete-task"},na={class:"msg"},ua={class:"dialog-footer"},da="/scheduledTasks",ia="/syncTask",pa="/addTask",ca="/alterTask",ma="/taskToogle",_a="/deleteTask",va={__name:"scheduledTask",setup(be){const R=c([]),z=c(!1),$=async()=>{z.value=!0;try{const C=await K.get(da);C.code==200?R.value=C.data:p.error(C.msg||"获取数据失败")}catch(C){p.error(C.msg||"请求错误！"),console.log(C)}finally{z.value=!1}};$();const T=c(!1),i=async()=>{T.value=!0;try{const C=await K.get(ia);C.code==200?de.success({title:"同步成功！",showClose:!1}):p.error(C.msg||"同步失败")}catch(C){T.value=!1,p.error(C.msg||"请求错误！"),console.log(C)}finally{T.value=!1}},d=c(!1);let J="";const h=c(!1),X=c(!1),u=c({task_name:"",command:"",enabled:0,period:"daily",day:"*",hour:"*",minute:"*",month:"*",week:"*"}),v=c({}),x={...u.value},Q={task_name:[{required:!0,message:"任务名称不能为空",trigger:"blur"},{pattern:/^[a-zA-Z0-9\u4e00-\u9fa5_]+$/,message:"任务名称不允许包含特殊字符",trigger:"blur"}],command:[{required:!0,message:"命令路径不能为空",trigger:"blur"},{pattern:/^\/?[\w\/-]+(\.\w+)?$/,message:"命令路径格式不正确，必须是路径格式，例如 /opt/iptv/scripts/python/iptv",trigger:"blur"}],minute:[{required:!0,message:"分钟不能为空",trigger:"blur"},{pattern:/^(\*|[0-5]?[0-9])$/,message:"分钟必须是0-59之间的数字，或者使用'*'",trigger:"blur"}],hour:[{required:!0,message:"小时不能为空",trigger:"blur"},{pattern:/^(\*|[0-1]?[0-9]|2[0-3])$/,message:"小时必须是0-23之间的数字，或者使用'*'",trigger:"blur"}],day:[{required:!0,message:"日期不能为空",trigger:"blur"},{pattern:/^(\*|[1-9]|[12][0-9]|3[01])$/,message:"日期必须是1-31之间的数字，或者使用'*'",trigger:"blur"}],month:[{required:!0,message:"月份不能为空",trigger:"blur"},{pattern:/^(\*|[1-9]|1[0-2])$/,message:"月份必须是1-12之间的数字，或者使用'*'",trigger:"blur"}],week:[{required:!0,message:"星期不能为空",trigger:"blur"},{pattern:/^(\*|[0-6])$/,message:"星期必须是0-6的数字 (0是星期日) 或 * 表示每周每天",trigger:"blur"}]},P={task_name:{label:"任务名称",type:"input",placeholder:"如：更新EPG数据",desc:"填写任务的名称，用于在列表中区分不同任务"},command:{label:"命令路径",type:"input",placeholder:"如：/opt/iptv/scripts/python/iptv",desc:"要执行的完整命令，例如：cd /app && node src/scripts/updateEpg.js"},period:{label:"周期类型",type:"select",options:[{label:"每小时",value:"hourly"},{label:"每日",value:"daily"},{label:"每周",value:"weekly"},{label:"每月",value:"monthly"},{label:"自定义Cron表达式",value:"cron"}],placeholder:"选择任务执行周期",desc:"选择任务的执行周期"},minute:{label:"分",type:"number",desc:"0-59 或 * 表示每分钟"},hour:{label:"时",type:"number",desc:"0-23 或 * 表示每时"},day:{label:"日",type:"number",desc:"1-31 或 * 表示每天"},month:{label:"月",type:"number",desc:"1-12 或 * 表示每月"},week:{label:"周几",type:"select",desc:"0-6 (0是星期日) 或 * 表示每周每天"},enabled:{label:"启用此任务",type:"switch",desc:"启用或禁用任务"}},q=c(null),j=(C,r)=>{C=="add"?(h.value=!1,J=pa,u.value={...x}):C=="edit"&&(h.value=!0,J=ca,u.value={...r},v.value={...r}),q.value&&q.value.clearValidate(),d.value=!0},w=()=>{q.value.validate(async C=>{if(C){if(h.value&&JSON.stringify(u.value)==JSON.stringify(v.value))return p.info("未作出修改！");let r={};h.value?r={id:u.value.id,data:u.value}:r=u.value,X.value=!0;try{const S=await K.get(J,{params:r});S.code==200?(d.value=!1,de.success({title:h.value?"修改":"添加任务成功！",showClose:!1}),$()):p.error(S.msg||"保存失败")}catch(S){p.error(S.msg||"请求错误！"),console.log(S)}finally{X.value=!1}}})},s=ul(()=>({minute:!1,hour:!1,day:!1,month:!1,week:!1,...{hourly:{minute:!0},daily:{hour:!0,minute:!0},weekly:{hour:!0,minute:!0,week:!0},monthly:{hour:!0,minute:!0,day:!0},cron:{hour:!0,minute:!0,day:!0,month:!0,week:!0}}[u.value.period]||{}})),_=c(null),g=C=>{_.value&&clearTimeout(_.value),_.value=setTimeout(()=>{L(C)},500)},L=async C=>{const r=C.enabled,S=r==!0?"启用任务":"禁用任务",D={id:C.id,enabled:r};try{const I=await K.get(ma,{params:D});I.code==200?de.success({title:S+"成功！",showClose:!1}):(C.enabled=!r,p.error(I.msg||"操作失败"))}catch(I){C.enabled=!r,p.error(I.msg||"请求错误！"),console.log(I)}},N=c(!1),H=c(!1),U=c(""),ee=C=>{N.value=!0,U.value=C},Y=async()=>{H.value=!0;const C={id:U.value.id};try{const r=await K.get(_a,{params:C});r.code==200?(de.success({title:"删除任务成功！",showClose:!1}),N.value=!1,$()):(p.error(r.msg||"删除任务失败"),console.log(r.msg))}catch(r){p.error(r.msg||"请求错误！"),console.log(r)}finally{H.value=!1}};return(C,r)=>{const S=y("Refresh"),D=ge,I=ke,le=y("Plus"),W=He,se=dl,O=Ee,o=y("Edit"),a=y("Delete"),B=Ge,V=We,ie=Be,me=y("Warning"),ye=Re,_e=y("AlarmClock"),Ue=y("PriceTag"),re=Ce,oe=Se,xe=y("Postcard"),ne=y("Calendar"),Z=Fe,Pe=De,pe=Te,he=we,Ie=$e,ve=Xe,Ve=Je;return n(),A("div",$t,[t("div",wt,[r[16]||(r[16]=t("div",{class:"title hidden-xs-only"},"定时任务配置",-1)),t("div",Tt,[l(I,{type:"primary",size:"large",onClick:i,loading:T.value},{icon:e(()=>[l(D,null,{default:e(()=>[l(S)]),_:1})]),default:e(()=>[r[14]||(r[14]=M(" 同步到系统 ",-1))]),_:1,__:[14]},8,["loading"]),l(I,{type:"success",size:"large",onClick:r[0]||(r[0]=f=>j("add"))},{icon:e(()=>[l(D,null,{default:e(()=>[l(le)]),_:1})]),default:e(()=>[r[15]||(r[15]=M(" 添加任务 ",-1))]),_:1,__:[15]})])]),t("div",St,[Le((n(),m(ie,{data:R.value,"header-row-class-name":"scheduled-task-table-header"},{empty:e(()=>[l(V,{"image-size":100,class:"table-empty",description:"暂无数据"})]),default:e(()=>[l(W,{label:"#",type:"index",width:"50"}),l(W,{prop:"task_name",label:"任务名称","min-width":"130","show-overflow-tooltip":""}),l(W,{prop:"time",label:"时间表达式（分 时 日 月 周）",width:"220"},{default:e(({row:f})=>[t("span",Rt,[l(se,{type:"info"},{default:e(()=>[M(k(f.minute),1)]),_:2},1024)]),t("span",Ut,[l(se,{type:"info"},{default:e(()=>[M(k(f.hour),1)]),_:2},1024)]),t("span",It,[l(se,{type:"info"},{default:e(()=>[M(k(f.day),1)]),_:2},1024)]),t("span",zt,[l(se,{type:"info"},{default:e(()=>[M(k(f.month),1)]),_:2},1024)]),t("span",Dt,[l(se,{type:"info"},{default:e(()=>[M(k(f.week),1)]),_:2},1024)])]),_:1}),l(W,{prop:"command",label:"命令","min-width":"260","show-overflow-tooltip":""}),l(W,{label:"状态",width:"80"},{default:e(({row:f})=>[l(O,{modelValue:f.enabled,"onUpdate:modelValue":ue=>f.enabled=ue,onChange:ue=>g(f)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(W,{label:"操作",width:"120"},{default:e(({row:f})=>[t("div",Ft,[l(B,null,{default:e(()=>[l(I,{type:"primary",onClick:ue=>j("edit",f)},{default:e(()=>[l(D,null,{default:e(()=>[l(o)]),_:1})]),_:2},1032,["onClick"]),l(I,{type:"danger",onClick:ue=>ee(f)},{default:e(()=>[l(D,null,{default:e(()=>[l(a)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[Ve,z.value]])]),l(ye,null,{header:e(()=>[t("p",At,[l(D,{size:16},{default:e(()=>[l(me)]),_:1}),r[17]||(r[17]=t("span",null,"提示信息",-1))])]),default:e(()=>[r[18]||(r[18]=t("ul",null,[t("li",null,"时间表达式采用标准crontab格式，依次为：分钟 小时 日 月 星期"),t("li",null,"星期取值为0-6，其中0表示星期日"),t("li",null,' 添加或修改任务后，建议点击"同步到系统"按钮将任务同步到系统crontab '),t("li",null,"若系统环境不支持crontab，任务仍会保存在数据库中")],-1))]),_:1,__:[18]}),l(ve,{modelValue:d.value,"onUpdate:modelValue":r[11]||(r[11]=f=>d.value=f),title:"Tips",width:"500","align-center":"",class:"my-dialog primary dialog-max-height"},{header:e(()=>[t("div",Et,[l(D,{size:20},{default:e(()=>[l(_e)]),_:1}),t("span",null,k(h.value?"编辑":"添加")+"定时任务",1)])]),footer:e(()=>[t("div",sa,[l(I,{onClick:r[10]||(r[10]=f=>d.value=!1)},{default:e(()=>r[19]||(r[19]=[M("取消",-1)])),_:1,__:[19]}),l(I,{type:"primary",onClick:w,loading:X.value},{default:e(()=>r[20]||(r[20]=[M("确认",-1)])),_:1,__:[20]},8,["loading"])])]),default:e(()=>[t("div",Mt,[l(Ie,{ref_key:"saveTaskFormRef",ref:q,model:u.value,rules:Q,"label-width":"100px","label-position":"top"},{default:e(()=>[l(oe,{prop:"task_name",label:P.task_name.label},{default:e(()=>[l(re,{size:"large",placeholder:P.task_name.placeholder,modelValue:u.value.task_name,"onUpdate:modelValue":r[1]||(r[1]=f=>u.value.task_name=f)},{prefix:e(()=>[l(D,null,{default:e(()=>[l(Ue)]),_:1})]),_:1},8,["placeholder","modelValue"]),t("p",Nt,k(P.task_name.desc),1)]),_:1},8,["label"]),l(oe,{label:P.command.label,prop:"task_name"},{default:e(()=>[l(re,{size:"large",placeholder:P.command.placeholder,modelValue:u.value.command,"onUpdate:modelValue":r[2]||(r[2]=f=>u.value.command=f)},{prefix:e(()=>[l(D,null,{default:e(()=>[l(xe)]),_:1})]),_:1},8,["placeholder","modelValue"]),t("p",qt,k(P.command.desc),1)]),_:1},8,["label"]),l(oe,{label:P.period.label,prop:"period"},{default:e(()=>[l(Pe,{size:"large",placeholder:P.period.placeholder,modelValue:u.value.period,"onUpdate:modelValue":r[3]||(r[3]=f=>u.value.period=f)},{prefix:e(()=>[l(D,null,{default:e(()=>[l(ne)]),_:1})]),default:e(()=>[(n(!0),A(te,null,ae(P.period.options,f=>(n(),m(Z,{key:f.value,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),l(he,{gutter:10,class:"cron"},{default:e(()=>[s.value.month?(n(),m(pe,{key:0,span:u.value.period==="cron"?24:12},{default:e(()=>[t("p",Ot,[M(k(P.month.label)+" ",1),t("span",Lt,k(P.month.desc),1)]),l(oe,{prop:"month"},{default:e(()=>[l(re,{size:"large",modelValue:u.value.month,"onUpdate:modelValue":r[4]||(r[4]=f=>u.value.month=f),min:"1",max:"12"},{prefix:e(()=>[l(D,null,{default:e(()=>[l(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["span"])):b("",!0),s.value.week?(n(),m(pe,{key:1,span:u.value.period==="weekly"?24:12},{default:e(()=>[t("p",Bt,[M(k(P.week.label)+" ",1),t("span",Ht,k(P.week.desc),1)]),l(oe,{prop:"week"},{default:e(()=>[l(re,{size:"large",modelValue:u.value.week,"onUpdate:modelValue":r[5]||(r[5]=f=>u.value.week=f),min:"0",max:"6"},{prefix:e(()=>[l(D,null,{default:e(()=>[l(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1}),u.value.period==="weekly"?(n(),A("span",Gt,"每周的哪一天执行")):b("",!0)]),_:1},8,["span"])):b("",!0),s.value.day?(n(),m(pe,{key:2,span:u.value.period==="monthly"?24:12},{default:e(()=>[t("p",Wt,[M(k(P.day.label)+" ",1),t("span",Jt,k(P.day.desc),1)]),l(oe,{prop:"day"},{default:e(()=>[l(re,{size:"large",modelValue:u.value.day,"onUpdate:modelValue":r[6]||(r[6]=f=>u.value.day=f),min:"1",max:"31"},{prefix:e(()=>[l(D,null,{default:e(()=>[l(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1}),u.value.period==="monthly"?(n(),A("span",Xt,"每月的哪一天执行")):b("",!0)]),_:1},8,["span"])):b("",!0),s.value.hour?(n(),m(pe,{key:3,span:12},{default:e(()=>[t("p",Kt,[M(k(P.hour.label)+" ",1),t("span",Zt,k(P.hour.desc),1)]),l(oe,{prop:"hour"},{default:e(()=>[l(re,{size:"large",modelValue:u.value.hour,"onUpdate:modelValue":r[7]||(r[7]=f=>u.value.hour=f),min:"0",max:"23"},{prefix:e(()=>[l(D,null,{default:e(()=>[l(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1}),u.value.period!=="cron"?(n(),A("span",jt,"执行时间（小时）")):b("",!0)]),_:1})):b("",!0),s.value.minute?(n(),m(pe,{key:4,span:u.value.period==="hourly"?24:12},{default:e(()=>[t("p",Qt,[M(k(P.minute.label)+" ",1),t("span",Yt,k(P.minute.desc),1)]),l(oe,{prop:"minute"},{default:e(()=>[l(re,{size:"large",modelValue:u.value.minute,"onUpdate:modelValue":r[8]||(r[8]=f=>u.value.minute=f),min:"0",max:"59"},{prefix:e(()=>[l(D,null,{default:e(()=>[l(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1}),u.value.period==="hourly"?(n(),A("span",ea,"每小时的哪一分钟执行")):b("",!0),u.value.period!=="cron"&&u.value.period!=="hourly"?(n(),A("span",la,"执行时间（分钟）")):b("",!0)]),_:1},8,["span"])):b("",!0)]),_:1}),t("div",ta,[t("span",aa,k(P.enabled.label),1),l(O,{modelValue:u.value.enabled,"onUpdate:modelValue":r[9]||(r[9]=f=>u.value.enabled=f)},null,8,["modelValue"])])]),_:1},8,["model"])]),r[21]||(r[21]=t("div",{class:"tips"},"可用 * 表示所有范围",-1))]),_:1,__:[21]},8,["modelValue"]),l(ve,{modelValue:N.value,"onUpdate:modelValue":r[13]||(r[13]=f=>N.value=f),title:"Tips",width:"500","align-center":"",class:"my-dialog danger"},{header:e(()=>[t("div",oa,[l(D,{size:20},{default:e(()=>[l(a)]),_:1}),r[22]||(r[22]=t("span",null,"删除定时任务",-1))])]),footer:e(()=>[t("div",ua,[l(I,{onClick:r[12]||(r[12]=f=>N.value=!1)},{default:e(()=>r[25]||(r[25]=[M("取消",-1)])),_:1,__:[25]}),l(I,{type:"danger",onClick:Y,loading:H.value},{default:e(()=>r[26]||(r[26]=[M("确认",-1)])),_:1,__:[26]},8,["loading"])])]),default:e(()=>[t("div",ra,[r[24]||(r[24]=t("p",{class:"title"}," 确定要删除这个定时任务吗？删除后将从系统crontab中移除。 ",-1)),t("div",na,[r[23]||(r[23]=t("span",{class:"msg-label"},"删除任务名称：",-1)),t("span",null,k(U.value.task_name||""),1)])])]),_:1},8,["modelValue"])])}}},fa=fe(va,[["__scopeId","data-v-9231eafc"]]),ga={class:"tvb-config"},ba={class:"header"},ya={class:"btn-wrap"},ha={class:"card-title"},Ca={class:"desc"},ka="在此设置香港TVB直播的API令牌，用于访问TVB频道内容。请确保令牌有效且未过期。",xa="/tvbConfig",Pa="/alterTvbConfig",Va={__name:"tvbConfig",setup(be){const R=c(""),z=c(""),$=c(!1),T=c(!1),i=()=>{$.value&&(R.value="")},d=()=>{T.value||($.value=!1,R.value=z.value)},J=c(!1),h=async()=>{J.value=!0;try{const v=await K.get(xa);v.code==200?(R.value=v.data.apiToken,z.value=v.data.apiToken):p.error(v.msg||"获取数据失败")}catch(v){p.error(v.msg||"请求失败!"),console.log(v)}finally{J.value=!1}};h();const X=()=>{if(J.value)return p.info("数据加载中，请稍后操作！");$.value=!0},u=async()=>{if(R.value.trim()=="")return R.value="",p.info("请输入API令牌!");if(R.value==z.value)return p.info("未修改内容!");T.value=!0;const v={apiToken:R.value};try{const x=await K.get(Pa,{params:v});x.code==200?(de.success({title:"保存成功！",showClose:!1}),$.value=!1,h()):(p.error(x.msg||"保存失败"),console.log(x.msg))}catch(x){p.error(x.msg||"请求失败!"),console.log(x)}finally{T.value=!1}};return(v,x)=>{const Q=y("Edit"),P=ge,q=ke,j=y("Close"),w=y("Select"),s=y("Monitor"),_=il,g=y("Key"),L=y("CircleClose"),N=Ce,H=y("Warning"),U=Re;return n(),A("div",ga,[t("div",ba,[x[4]||(x[4]=t("div",{class:"title hidden-xs-only"},"TVB配置",-1)),t("div",ya,[$.value?b("",!0):(n(),m(q,{key:0,type:"primary",size:"large",onClick:X},{icon:e(()=>[l(P,null,{default:e(()=>[l(Q)]),_:1})]),default:e(()=>[x[1]||(x[1]=M(" 编辑配置 ",-1))]),_:1,__:[1]})),$.value?(n(),m(q,{key:1,type:"danger",size:"large",onClick:d,disabled:T.value},{icon:e(()=>[l(P,null,{default:e(()=>[l(j)]),_:1})]),default:e(()=>[x[2]||(x[2]=M(" 取消 ",-1))]),_:1,__:[2]},8,["disabled"])):b("",!0),$.value?(n(),m(q,{key:2,type:"success",size:"large",onClick:u,loading:T.value},{icon:e(()=>[l(P,null,{default:e(()=>[l(w)]),_:1})]),default:e(()=>[x[3]||(x[3]=M(" 保存配置 ",-1))]),_:1,__:[3]},8,["loading"])):b("",!0)])]),l(U,{"header-class":"tvb-config-card-header","body-class":"card-body"},{header:e(()=>[t("p",ha,[l(P,null,{default:e(()=>[l(s)]),_:1}),x[5]||(x[5]=t("span",null,"TVB API令牌配置",-1))])]),default:e(()=>[l(_,{title:ka,type:"primary","show-icon":"",closable:!1}),x[7]||(x[7]=t("p",{class:"title"},"API令牌",-1)),l(N,{modelValue:R.value,"onUpdate:modelValue":x[0]||(x[0]=ee=>R.value=ee),size:"large",placeholder:"请输入API令牌",disabled:!$.value},{prepend:e(()=>[l(P,null,{default:e(()=>[l(g)]),_:1})]),append:e(()=>[l(q,{onClick:i},{default:e(()=>[l(P,null,{default:e(()=>[l(L)]),_:1})]),_:1})]),_:1},8,["modelValue","disabled"]),t("p",Ca,[l(P,null,{default:e(()=>[l(H)]),_:1}),x[6]||(x[6]=t("span",null," 此令牌用于授权访问TVB频道，请妥善保管，定期更新",-1))])]),_:1,__:[7]})])}}},$a=fe(Va,[["__scopeId","data-v-dc1fe760"]]),wa={class:"system"},Ta={class:"tabs-label"},Sa={class:"tabs-label"},Ra={class:"tabs-label"},Ua={class:"tabs-label"},Ia={class:"tabs-label"},za={__name:"System",setup(be){const R=c("authData");return(z,$)=>{const T=y("Key"),i=ge,d=Ae,J=y("Monitor"),h=y("Files"),X=y("Switch"),u=y("AlarmClock"),v=Me;return n(),A("main",wa,[l(v,{modelValue:R.value,"onUpdate:modelValue":$[0]||($[0]=x=>R.value=x),class:"demo-tabs",type:"border-card"},{default:e(()=>[l(d,{name:"authData"},{label:e(()=>[t("span",Ta,[l(i,{size:16,class:"tabs-icon"},{default:e(()=>[l(T)]),_:1}),$[1]||($[1]=t("span",{class:"tabs-title"},"认证数据",-1))])]),default:e(()=>[l(kl)]),_:1}),l(d,{name:"tvbConfig"},{label:e(()=>[t("span",Sa,[l(i,{size:16,class:"tabs-icon"},{default:e(()=>[l(J)]),_:1}),$[2]||($[2]=t("span",{class:"tabs-title"},"TVB配置",-1))])]),default:e(()=>[l($a)]),_:1}),l(d,{name:"iptvConfig"},{label:e(()=>[t("span",Ra,[l(i,{size:16,class:"tabs-icon"},{default:e(()=>[l(h)]),_:1}),$[3]||($[3]=t("span",{class:"tabs-title"},"IPTV配置",-1))])]),default:e(()=>[l(Hl)]),_:1}),l(d,{name:"rtspProxy"},{label:e(()=>[t("span",Ua,[l(i,{size:16,class:"tabs-icon"},{default:e(()=>[l(X)]),_:1}),$[4]||($[4]=t("span",{class:"tabs-title"},"RTSP代理",-1))])]),default:e(()=>[l(Vt)]),_:1}),l(d,{name:"scheduledTask"},{label:e(()=>[t("span",Ia,[l(i,{size:16,class:"tabs-icon"},{default:e(()=>[l(u)]),_:1}),$[5]||($[5]=t("span",{class:"tabs-title"},"定时任务",-1))])]),default:e(()=>[l(fa)]),_:1})]),_:1},8,["modelValue"])])}}},Oa=fe(za,[["__scopeId","data-v-1d3a5551"]]);export{Oa as default};
